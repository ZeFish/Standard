@use "standard-00-variables" as *;

/**
 * @component Markdown Styling
 * @category Components
 * @description Beautiful styling for markdown-generated HTML. Includes support for
 * blockquotes, callouts, code blocks, tables, lists, and other common markdown elements.
 * Designed to work seamlessly with the rhythm and reading layout systems.
 * Automatically styles headings, paragraphs, links with proper typography.
 *
 * @prop {class} .md Apply markdown styling to container
 * @prop {element} blockquote Styled blockquote with italic text
 * @prop {class} .callout Highlighted callout/admonition blocks
 * @prop {class} .callout-title Title for callout blocks
 * @prop {element} pre Code block with syntax highlighting
 * @prop {element} code Inline code styling
 * @prop {element} table Responsive table styling
 * @prop {element} a Link styling with underline
 * @prop {element} h1-h6 Heading hierarchy with proper sizing
 *
 * @example
 * // Apply markdown styling to content
 * <article class="reading md">
 *   <h1>Title</h1>
 *   <p>Paragraph text...</p>
 *   <blockquote>Quote</blockquote>
 *   <pre><code>Code block</code></pre>
 * </article>
 *
 * // Callout admonition block
 * <div class="callout">
 *   <div class="callout-title">Note</div>
 *   <div class="callout-content">Important information</div>
 * </div>
 *
 * @since 0.1.0
 * @see standard-09-md.scss
 */

// Harmonized Markdown Styles - Using logical properties
// Works with both .prose (layout) and .rhythm (spacing) classes

.md {
    // ==========================
    // General Element Styling
    // ==========================
    .callout,
    pre,
    blockquote,
    img,
    iframe,
    .outset,
    .inset,
    .box,
    .box-inset {
        background: var(--color-background-secondary);
        border-radius: var(--border-radius);
        border: var(--border);
        box-shadow: var(--shadow);
    }
    pre,
    blockquote .inset,
    .box-inset {
        box-shadow: inset var(--shadow);
    }

    // ==========================
    // BLOCKQUOTE
    // ==========================
    blockquote {
        font-size: var(--scale-s);
        line-height: var(--font-density-s);
        padding: var(--space);
        font-style: italic;
    }

    // ==========================
    // CALLOUT
    // ==========================
    .callout {
        line-height: var(--font-density-s);
        transition: var(--duration-superfast) var(--motion-smooth);
        padding: var(--space-2xs);
        --color-callout: var(--color-background-secondary);
        --color-border: color-mix(
            in srgb,
            var(--color-callout) 15%,
            transparent
        );
        background: color-mix(
            in srgb,
            var(--color-callout) 5%,
            var(--color-background-secondary)
        );
        border: var(--border);

        .callout-title {
            color: color-mix(
                in srgb,
                var(--color-callout) 50%,
                var(--color-foreground)
            );
            font-weight: bold;
            font-size: var(--scale-s);
            user-select: none;
            padding: var(--space-3xs) calc(var(--space) - var(--space-xs))
                var(--space-3xs) calc(var(--space) - var(--space-xs));
        }

        .callout-content {
            color: var(--color-foreground);
            background: color-mix(
                in srgb,
                var(--color-callout) 2.5%,
                var(--color-background)
            );

            box-shadow: inset var(--shadow);
            font-size: var(--scale-s);
            overflow: hidden;
            border-radius: var(--border-radius);
            padding: var(--space-s) calc(var(--space) - var(--space-xs));
            margin-top: var(--space-2xs);
            margin-left: 0;
            border: var(--border);
            text-align: left;

            p:first-child {
                margin-top: 0;
            }
            p:last-child {
                margin-bottom: 0;
            }

            ul,
            ol {
                padding: 0 calc(var(--space) * 0.75);
            }

            pre {
                margin: var(--space) 0;
            }

            > .callout {
                margin: calc(var(--space-xs) * -1);

                .callout-content {
                    padding: var(--space-s);
                }

                .callout-title {
                    padding-left: var(--space-s);
                    padding-right: var(--space-s);
                }
            }
        }

        .callout-title-icon {
            display: none;
        }

        img {
            margin-left: 0;
            margin-right: 0;
        }
    }

    // Callout Color Variants
    .callout[data-callout="warning" i] {
        --color-callout: var(--color-red);
    }
    .callout[data-callout="important" i] {
        --color-callout: var(--color-orange);
    }

    // Details/Summary specific callout styles
    details > summary {
        list-style: none; /* removes marker in Firefox */
    }

    details .callout-title::before {
        content: "â–¸";
        display: inline-block;
        transform: rotate(0deg);
        transition: transform 0.2s ease;
    }

    details[open] .callout-title::before {
        transform: rotate(90deg);
    }

    details .callout-title-inner {
        display: inline;
    }

    // Caption Callout (after an image)
    p:has(img) + .callout[data-callout="caption" i] {
        padding: 0;
        background: none;
        border: none;
        margin: 0 var(--space-l);
        position: relative;
        top: calc(var(--space) * -1.75);
        box-shadow: none;

        .callout-title {
            display: none;
        }

        .callout-content {
            padding: 0;
            background: none;
            border: none;
            box-shadow: none;
            line-height: 1;
            text-align: center !important;
            text-wrap: balance !important;
        }
    }

    // ==========================
    // Mobile Specific Styles
    // ==========================
    @media only screen and (max-width: #{$small}) {
        ul:not([start]),
        ol:not([start]) {
            padding: 0;
            padding-left: var(--space);
        }
    }
}

@use "standard-00-variables" as *;

/**
 * @component Debug System
 * @category Development
 * @description Development debugging utilities for visualizing grid layouts,
 * baseline rhythm, reading zones, and typography processing. Activated by adding
 * .standard-debug class to body or parent element. Shows overlays for grid columns,
 * baseline rhythm, reading layout zones, and other layout metrics. Essential for
 * design system development and layout debugging. Automatically hidden in print.
 *
 * @prop {class} .standard-debug Enable debug visualization
 * @prop {overlay} baseline-grid Horizontal baseline grid overlay
 * @prop {overlay} grid-columns Vertical grid column overlay
 * @prop {overlay} reading-zones Reading layout zone visualization
 * @prop {overlay} rhythm-spacing Margin/spacing outline visualization
 * @prop {indicator} breakpoint-indicator Current responsive breakpoint
 * @prop {indicator} debug-panel Fixed info panel with metrics
 *
 * @example
 * // Enable debug mode on page
 * <body class="standard-debug">
 *   <!-- All debug overlays visible -->
 * </body>
 *
 * // Debug specific grid
 * <div class="grid standard-debug">
 *   <div class="col-4">Shows grid overlay</div>
 * </div>
 *
 * // Debug reading layout zones
 * <article class="reading standard-debug">
 *   <div class="accent">Zone highlighted</div>
 * </article>
 *
 * @since 0.1.0
 */

/* =========================== */
/* STANDARD DEBUG SYSTEM       */
/* =========================== */

/* Single class to enable all debug features */
.debug {
    display: none;
}

.standard-debug {
    position: relative;
}

.standard-debug .debug {
    display: inherit;
}

:root {
    --debug-line-opacity: 15%;
    --debug-outline-opacity: 50%;
}

.standard-debug::before,
.standard-debug::after,
.standard-debug :is(#{$rhythm-block-elements})::before,
.standard-debug :is(#{$rhythm-block-small})::before {
    content: "";
    color: var(--color-muted);
    border-radius: var(--radius);
    font-family: var(--font-monospace);
    font-size: var(--scale-d2);

    padding: var(--base-d8) var(--base-d4);
    border-radius: var(--radius);
    z-index: var(--z-toast);
    pointer-events: none;
    white-space: pre;
}
/* Baseline Grid Overlay */
.standard-debug::before {
    --color-grid: var(--color-cyan);
    --percent-grid: var(--debug-line-opacity);
    content: "";
    position: absolute;
    inset: 0;
    background-image: repeating-linear-gradient(
        to bottom,
        transparent 0,
        transparent calc(var(--base) - 1px),
        color-mix(in srgb, var(--color-grid) var(--percent-grid), transparent)
            calc(var(--base) - 1px),
        color-mix(in srgb, var(--color-grid) var(--percent-grid), transparent)
            var(--base)
    );
    pointer-events: none;
    z-index: 10000;
}
.standard-debug :is(#{$rhythm-elements}) {
    outline: 1px dashed
        color-mix(
            in srgb,
            var(--color-cyan) var(--debug-outline-opacity),
            transparent
        );
    outline-offset: var(--base);
}

.standard-debug :is(#{$rhythm-block-elements}) {
    position: relative;
}
.standard-debug :is(#{$rhythm-block-elements})::before {
    content: "Block";
    position: absolute;
    top: 0;
    left: calc(var(--base) * -2);
    transform: translateX(-100%);
    z-index: 999999999;
}
.standard-debug :is(#{$rhythm-block-small}) {
    position: relative;
    border: none;
}
.standard-debug :is(#{$rhythm-block-small})::before {
    content: "Small";
    position: absolute;
    top: 0;
    left: calc(var(--base) * -2);
    transform: translateX(-100%);
}

/* Reading Layout Debug - show zones */
.standard-debug .prose {
    position: relative;
}

.standard-debug .grid-debug-overlay {
    position: absolute;
    inset: 0;
    display: grid;
    grid-template-columns: inherit;
    pointer-events: none;
    z-index: 9999;
    grid-column: hero;

    span:nth-child(1) {
        grid-column: hero-start / feature-start;
    }
    span:nth-child(2) {
        grid-column: feature-start / accent-start;
        border-inline-start: 1px solid
            color-mix(
                in srgb,
                var(--color-cyan) var(--debug-line-opacity),
                transparent
            );
    }
    span:nth-child(3) {
        grid-column: accent-start / content-start;
        border-inline-start: 1px solid
            color-mix(
                in srgb,
                var(--color-accent) var(--debug-line-opacity),
                transparent
            );
    }
    span:nth-child(4) {
        grid-column: content;
        outline: 1px solid
            color-mix(
                in srgb,
                var(--color-green) var(--debug-line-opacity),
                transparent
            );
    }
    span:nth-child(5) {
        grid-column: content-end / accent-end;
        border-inline-end: 1px solid
            color-mix(
                in srgb,
                var(--color-accent) var(--debug-line-opacity),
                transparent
            );
    }
    span:nth-child(6) {
        grid-column: accent-end / feature-end;
        border-inline-end: 1px solid
            color-mix(
                in srgb,
                var(--color-cyan) var(--debug-line-opacity),
                transparent
            );
    }
    span:nth-child(7) {
        grid-column: feature-end / hero-end;
    }
}

/* Grid item debugging */
/* Grid Column Overlay (only for .grid inside debug) */
.standard-debug .grid,
.standard-debug .grid-2,
.standard-debug .grid-3,
.standard-debug .grid-4,
.standard-debug .grid-5,
.standard-debug .grid-6,
.standard-debug .grid-7,
.standard-debug .grid-8,
.standard-debug .grid-9,
.standard-debug .grid-10,
.standard-debug .grid-11,
.standard-debug .grid-12 {
    position: relative;
}
.standard-debug .grid::after,
.standard-debug .grid-2::after,
.standard-debug .grid-3::after,
.standard-debug .grid-4::after,
.standard-debug .grid-5::after,
.standard-debug .grid-6::after,
.standard-debug .grid-7::after,
.standard-debug .grid-8::after,
.standard-debug .grid-9::after,
.standard-debug .grid-10::after,
.standard-debug .grid-11::after,
.standard-debug .grid-12::after {
    content: "";
    position: absolute;
    inset: 0;
    display: grid;
    grid-template-columns: repeat(var(--grid-cols), 1fr);
    column-gap: var(--grid-gap);
    pointer-events: none;
    z-index: var(--z-tooltip);
    background-image: repeating-linear-gradient(
        to right,
        color-mix(in srgb, var(--color-red) 10%, transparent) 0,
        color-mix(in srgb, var(--color-red) 10%, transparent)
            calc(
                (100% - (var(--grid-gap) * (var(--grid-cols) - 1))) /
                    var(--grid-cols)
            ),
        transparent
            calc(
                (100% - (var(--grid-gap) * (var(--grid-cols) - 1))) /
                    var(--grid-cols)
            ),
        transparent
            calc(
                (100% - (var(--grid-gap) * (var(--grid-cols) - 1))) /
                    var(--grid-cols) + var(--grid-gap)
            )
    );
}
.standard-debug .grid > *,
.standard-debug .grid-2 > *,
.standard-debug .grid-3 > *,
.standard-debug .grid-4 > *,
.standard-debug .grid-5 > *,
.standard-debug .grid-6 > *,
.standard-debug .grid-7 > *,
.standard-debug .grid-8 > *,
.standard-debug .grid-9 > *,
.standard-debug .grid-10 > *,
.standard-debug .grid-11 > *,
.standard-debug .grid-12 > * {
    outline: 1px solid color-mix(in srgb, var(--color-cyan) 50%, transparent);
    outline-offset: -1px;
    position: relative;
}

.standard-debug .grid > *::before,
.standard-debug .grid-2 > *::before,
.standard-debug .grid-3 > *::before,
.standard-debug .grid-4 > *::before,
.standard-debug .grid-5 > *::before,
.standard-debug .grid-6 > *::before,
.standard-debug .grid-7 > *::before,
.standard-debug .grid-8 > *::before,
.standard-debug .grid-9 > *::before,
.standard-debug .grid-10 > *::before,
.standard-debug .grid-11 > *::before,
.standard-debug .grid-12 > *::before {
    content: attr(class);
    position: absolute;
    top: var(--base-d8);
    left: var(--base-d8);
    background: var(--color-cyan);
    color: var(--color-background);
    font-size: var(--scale-d3);
    font-family: var(--font-monospace);
    padding: var(--base-d8) var(--base-d4);
    border-radius: var(--radius);
    pointer-events: none;
    opacity: 0.9;
    z-index: var(--z-tooltip);
    white-space: nowrap;
    max-width: 90%;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Free column debug */
.standard-debug .free-col::after {
    content: "start: " var(--start) " / span: " var(--span);
    position: absolute;
    bottom: var(--base-d8);
    left: var(--base-d8);
    background: var(--color-purple);
    color: var(--color-background);
    font-size: var(--scale-d3);
    font-family: var(--font-monospace);
    padding: var(--base-d8) var(--base-d4);
    border-radius: var(--radius);
    pointer-events: none;
    opacity: 0.9;
    z-index: var(--z-tooltip);
    white-space: nowrap;
}

/* Debug Info Panel */
.standard-debug::after {
    content: "Debug";
    position: fixed;
    top: var(--base);
    left: var(--base);
}

@media (max-width: #{$small}) {
    .standard-debug::after {
        content: "Debug : sm (<#{$small})";
    }
}

@media (max-width: 600px) {
    .standard-debug::after {
        content: "Debug : xs (<600px)";
    }
}

@media (min-width: #{$large}) {
    .standard-debug::after {
        content: "Debug : lg (â‰¥#{$large})";
    }
}

/* Print debug styles */
@media print {
    .standard-debug::before,
    .standard-debug::after,
    .standard-debug .grid::after,
    .standard-debug .prose::after,
    body.standard-debug::before {
        display: none !important;
    }
}

/* Dark mode adjustments for debug */
@media (prefers-color-scheme: dark) {
    .standard-debug::before {
        opacity: 0.3;
    }

    .standard-debug .prose::after {
        opacity: 0.15;
    }
}

/* Prose Layout Design Tokens - Using logical properties */
:root {
    /* Content area tokens */
    --line-width-xs: 24rem; /* ~384px - narrow sidebar content */
    --line-width-s: 32rem; /* ~512px - short form content */
    --line-width-m: 42rem; /* ~672px - optimal reading (60-75 chars) - DEFAULT */
    --line-width-l: 50rem; /* ~800px - wider articles */
    --line-width-xl: 60rem; /* ~960px - documentation/wide content */
    --line-width-full: calc(
        100vw - (var(--space) * 2)
    ); /* responsive full width with margins */
    --line-width: var(--line-width-m);

    /* Layout grid tokens */
    --gap: clamp(var(--space), 6vw, var(--space-xl));
    --content: min(var(--line-width), 100% - var(--gap) * 2); /* ← FIXED */
    --content-small: var(--space-l);
    --content-accent: minmax(0, var(--space-l));
    --content-feature: minmax(0, var(--space-2xl));
    --content-full: minmax(0, 1fr);
}

/* Responsive adjustments - collapse gutters on small screens */
@media only screen and (max-width: 668px) {
    :root {
        --content-small: 0;
        --content: min(var(--line-width), 100%); /* ← FIXED */
        --content-accent: 0;
        --content-feature: 0;
        --content-full: 0; /* Just the minimum gap */
    }
}

/* Reading Layout System - Article content grid and positioning */
/* Inspired by fine-art typography and book design principles */

.reading {
    display: grid;
    grid-template-columns:
        [full-start] var(--content-full)
        [feature-start] var(--content-feature)
        [accent-start] var(--content-accent)
        [content-start] var(--content) [content-end]
        var(--content-accent) [accent-end]
        var(--content-feature) [feature-end]
        var(--content-full) [full-end];

    transition: grid-template-columns 0.3s ease-out;

    position: relative;
    z-index: var(--z-base);
    /* Default content positioning */
    > * {
        grid-column: content;
    }

    .small {
        grid-column: content;
        margin-inline: var(--content-small);
    }

    .accent {
        grid-column: accent;
        margin-inline: 0;
    }

    .feature {
        grid-column: feature;
        margin-inline: 0;
    }

    .full {
        grid-column: full;
        margin-inline: 0;
    }

    /* Image gallery layout */
    &:not(.no-grid) {
        p:has(img) {
            display: flex;
            gap: calc(var(--space) / 4);
            border-radius: var(--border-radius);
        }

        p:has(img) > * {
            flex: 1 1 auto;
            min-width: 1%;
            min-height: 1%;
            object-fit: cover;
        }

        p:has(video) > * {
            flex: 1 1 auto;
            min-width: 1%;
            min-height: 1%;
            object-fit: cover;
        }

        p:has(img) img,
        p:has(img) img:first-child,
        p:has(img) img:last-child {
            margin-inline: auto;
        }

        p:has(img) br {
            display: none;
        }

        .callout p:has(img),
        .callout p:has(img) br {
            display: block;
        }
    }

    h1 {
        margin: var(--space-3xl) 0 var(--space-l) 0;
    }

    h2 {
        margin: var(--space-2xl) 0 var(--space-l) 0;
    }

    h3 {
        margin: var(--space-xl) 0 var(--space-l) 0;
    }

    h4 {
        margin: var(--space-l) 0 var(--space) 0;
    }

    h5 {
        margin: var(--space) 0 var(--space-s) 0;
    }

    h6 {
        margin: var(--space) 0 var(--space-xs) 0;
    }

    hr {
        margin-block-start: var(--space-l);
        margin-block-end: var(--space-xl);
        margin-inline: calc(var(--space-l) * var(--rhythm-multiplier));
    }

    /* Heading after heading gets reduced spacing */
    h1 + h2,
    h2 + h3,
    h3 + h4,
    h4 + h5,
    h5 + h6 {
        margin-block-start: calc(
            var(--space-xs) * var(--rhythm-multiplier) * -1
        );
    }

    /* Lists after headings get normal spacing */
    h1 + ul,
    h1 + ol,
    h2 + ul,
    h2 + ol,
    h3 + ul,
    h3 + ol {
        margin-block-end: calc(var(--space) * var(--rhythm-multiplier));
    }

    /* Basic media styling */
    img,
    audio,
    video {
        margin: 0;
        margin-inline: auto;
        max-inline-size: 100%;
        border-radius: var(--border-radius);
        border: var(--border);
    }

    .callout,
    blockquote,
    pre,
    figure,
    p:has(img) {
        margin-inline: var(--content-small);
    }

    /* Mermaid diagrams */
    .mermaid {
        margin-block-end: var(--space);
        margin-inline: auto;
        padding: var(--space);
    }

    p img {
        max-inline-size: 100%;
    }
}

.width-xs {
    max-width: var(--line-width-xs);
}
.width-s {
    max-width: var(--line-width-s);
}
.width-m {
    max-width: var(--line-width-m);
}
.width-l {
    max-width: var(--line-width-l);
}
.width-xl {
    max-width: var(--line-width-xl);
}
.width-full {
    max-width: var(--line-width-full);
}

/* Animation keyframes */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(0.5rem);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

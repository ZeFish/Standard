class ${constructor(e={}){this.apiUrl=e.apiUrl||"/api/comments",this.pageId=e.pageId,this.container=typeof e.container=="string"?document.querySelector(e.container):e.container||document.querySelector("#comments"),this.formSelector=e.form||"#comment-form",this.comments=[],this.loading=!1,this.pollInterval=e.pollInterval||null,this.pollTimer=null,this.onLoad=e.onLoad||null,this.onRender=e.onRender||null}async load(){if(!this.pageId)return console.error("GitHubComments: pageId is required"),this.error="Configuration error: pageId is required",[];this.loading=!0,this.error=null;try{const e=await fetch(`${this.apiUrl}?pageId=${encodeURIComponent(this.pageId)}`);if(!e.ok)throw new Error(`API error: ${e.status}`);const t=await e.json();if(this.comments=t.comments||[],this.loading=!1,typeof this.onLoad=="function")try{this.onLoad(this.comments)}catch{}return this.comments}catch(e){return console.error("Error loading comments:",e),this.loading=!1,this.error=e.message||"Failed to load comments. Please try again later.",[]}}async submit(e){try{const t=await fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pageId:this.pageId,...e})});if(!t.ok){let n=`API error: ${t.status}`;try{n=(await t.json()).message||n}catch{n=`API endpoint not available (${t.status})`}throw new Error(n)}const a=await t.json();return a.comment&&(this.comments.push(a.comment),this.comments.sort((n,r)=>new Date(r.createdAt)-new Date(n.createdAt))),a}catch(t){throw console.error("Error submitting comment:",t),t}}formatTime(e){const t=new Date(e),n=Math.floor((new Date-t)/1e3);return n<60?"just now":n<3600?`${Math.floor(n/60)}m ago`:n<86400?`${Math.floor(n/3600)}h ago`:n<604800?`${Math.floor(n/86400)}d ago`:t.toLocaleDateString()}escapeHTML(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}formatContent(e){let t=this.escapeHTML(e);return t=t.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>"),t=t.replace(/\*(.+?)\*/g,"<em>$1</em>"),t=t.replace(/_(.+?)_/g,"<em>$1</em>"),t=t.replace(/```(.*?)```/gs,"<pre><code>$1</code></pre>"),t=t.replace(/`(.+?)`/g,"<code>$1</code>"),t=t.replace(/\[(.+?)\]\((.+?)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>'),t=t.replace(/\n/g,"<br>"),t}renderComment(e,t=0){const a=e.approved!==!1?"":' data-pending="true"',n=e.spam?' data-spam="true"':"";return`
      <div class="comment" data-id="${this.escapeHTML(String(e.id))}" data-level="${t}"${a}${n}>
        <div class="comment-header">
          <span class="comment-author">${this.escapeHTML(e.author||"Anonymous")}</span>
          <span class="comment-date">${this.formatTime(e.createdAt)}</span>
          ${e.spam?'<span class="comment-flag">Flagged as spam</span>':""}
          ${e.approved?"":'<span class="comment-pending">Awaiting moderation</span>'}
        </div>
        <div class="comment-content">${this.formatContent(e.content||"")}</div>
      </div>
    `}buildCommentTree(){const e={},t=[];for(const a of this.comments)e[a.id]={...a,replies:[]};for(const a of this.comments)a.parentId&&e[a.parentId]?e[a.parentId].replies.push(e[a.id]):t.push(e[a.id]);return t}renderTree(e,t=0){return e.map(a=>{let n=this.renderComment(a,t);return a.replies&&a.replies.length>0&&(n+=`<div class="comment-replies">${this.renderTree(a.replies,t+1)}</div>`),n}).join("")}updateFormVisibility(){const e=document.getElementById("show-comment-form-btn");e&&(this.error?e.style.display="none":e.style.display="")}render(){if(!this.container){console.error("GitHubComments: container not found");return}if(this.error){this.container.innerHTML=`
        <aside class="comments debug" role="alert">
          Error loading comments: ${this.escapeHTML(this.error)}
        </aside>
      `,this.updateFormVisibility();return}if(this.comments.length===0){this.container.innerHTML='<p class="comments-empty">No comments yet. Be the first to comment!</p>',this.updateFormVisibility();return}const e=this.buildCommentTree();if(this.container.innerHTML=this.renderTree(e),this.attachReplyHandlers(),this.updateFormVisibility(),typeof this.onRender=="function")try{this.onRender(this.container)}catch{}}attachReplyHandlers(){this.container&&this.container.querySelectorAll(".comment-reply").forEach(e=>{e.addEventListener("click",t=>{const a=t.target.dataset.parentId,n=document.querySelector(this.formSelector);if(n){const r=n.querySelector('[name="parentId"]');r&&(r.value=a),n.scrollIntoView({behavior:"smooth"})}})})}attachFormHandler(e=null){const t=document.querySelector(e||this.formSelector);if(t){if(t.removeAttribute("hx-boost"),t.setAttribute("hx-disable","true"),window.htmx){const a=t.cloneNode(!0);t.parentNode.replaceChild(a,t),document.querySelector(e||this.formSelector).addEventListener("submit",this._handleFormSubmit.bind(this));return}t.addEventListener("submit",this._handleFormSubmit.bind(this))}}async _handleFormSubmit(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();const t=e.target,a=new FormData(t),n={author:a.get("author"),email:a.get("email"),content:a.get("content"),parentId:a.get("parentId")||null},r=t.querySelector("button[type=submit]"),d=r?r.textContent:"",i=t.querySelector("#form-status");try{r&&(r.disabled=!0,r.textContent="Submitting...",r.style.opacity="0.7"),i&&(i.style.display="block",i.textContent="Sending your comment...",i.style.color="var(--color-foreground, #000)");const c=await this.submit(n);i&&(i.textContent="Comment submitted successfully! It will appear after moderation.",i.style.color="var(--color-green, green)",setTimeout(()=>{i.style.display="none",i.textContent=""},6e3)),t.reset();const h=t.querySelector('[name="parentId"]');return h&&(h.value=""),this.render(),c}catch(c){throw i&&(i.textContent=`Error: ${c.message}`,i.style.color="var(--color-red, red)",i.style.display="block"),c}finally{r&&(r.disabled=!1,r.textContent=d,r.style.opacity="1")}}startPolling(){this.pollInterval&&(this.stopPolling(),this.pollTimer=setInterval(async()=>{const e=this.comments.length;await this.load(),this.comments.length>e&&this.render()},this.pollInterval))}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}}function w(o){if(!o||typeof o!="string")return"index";let e=o.trim();try{e=new URL(e,window.location.origin).pathname}catch{}return e=e.replace(/^\/|\/$/g,""),e===""?"index":(e=e.replace(/[\/]+/g,"_"),e=e.replace(/[^A-Za-z0-9_-]/g,"_"),e)}const I={apiUrl:"/api/comments",containerSelector:"#comments",formSelector:"#comment-form",pollInterval:null,autoInit:!0,pageId:null,onLoad:null,onRender:null};let s=null,l={...I};function x(){if(typeof document>"u")return null;const o=document.querySelector("[data-page-id]")||document.body,e=o&&o.getAttribute&&o.getAttribute("data-page-id");if(e)return e;const t=document.querySelector('meta[name="page-id"]');if(t&&t.content)return t.content;const a=document.querySelector('meta[property="og:url"]');if(a&&a.content)try{return new URL(a.content).pathname}catch{return a.content}const n=document.querySelector('link[rel="canonical"]');if(n&&n.href)try{return new URL(n.href).pathname}catch{return n.href}return null}const g={version:"@VERSION_PLACEHOLDER@",configure(o={}){return Object.assign(l,o||{}),l},getInstance(){return s},createInstance(o={}){const e={apiUrl:l.apiUrl,container:o.container||l.containerSelector,form:o.formSelector||l.formSelector,pollInterval:o.pollInterval!=null?o.pollInterval:l.pollInterval,onLoad:o.onLoad||l.onLoad,onRender:o.onRender||l.onRender},t=o.pageId||l.pageId||x();return e.pageId=w(t||window.location.pathname),s=new $(e),s},async init(o={}){if(typeof document>"u")return null;if(s&&!o.recreate)return s;let e=o.container;e||(e=document.querySelector("[data-comments]")||document.querySelector(l.containerSelector)||l.containerSelector);const t=this.createInstance({...o,container:e});try{await t.load(),t.render()}catch{}try{t.attachFormHandler(o.formSelector||l.formSelector)}catch{}return t.pollInterval&&t.startPolling(),t},async load(){return s||await this.init(),s?s.load():[]},render(){if(!s){console.error("comments: not initialized");return}return s.render()},attachFormHandler(o){if(!s){console.error("comments: not initialized");return}return s.attachFormHandler(o)},submit(o){return s?s.submit(o):Promise.reject(new Error("comments: not initialized"))},startPolling(){if(!s){console.error("comments: not initialized");return}return s.startPolling()},stopPolling(){if(s)return s.stopPolling()},getPageId(){if(s&&s.pageId)return s.pageId;const o=l.pageId||x();return w(o||(typeof window<"u"?window.location.pathname:"index"))}};function k(){if(l.autoInit&&!s)try{g.init().catch(()=>{})}catch{}document.body.addEventListener("htmx:afterSettle",function(o){if(document.querySelector("#comments, [data-comments]")){const t=g.getInstance();t&&t.stopPolling(),g.init({recreate:!0})}})}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",k):k());typeof window<"u"&&(window.comments=g,window.GitHubComments=$);/*!
 * Standard System Inspector - Minimal Debug Interface
 *
 * A minimalist debug interface for the Standard Framework
 * Philosophy: Felt, not seen. Present when needed, invisible when not.
 *
 * HTMX-COMPATIBLE VERSION: Includes a .refresh() method and stable IDs
 * to work with htmx:load events and hx-preserve.
 *
 * @version @VERSION_PLACEHOLDER@
 */class S{constructor(){this.state="dormant",this.badge=null,this.panel=null,this.currentTab="typography",this.googleFontsLoaded=new Set,this.colorScheme=this.detectColorScheme(),this.modifiedTokens=new Set,this.position=this.loadPosition(),this.version=document.documentElement.dataset.standardVersion,this.customThemes=[],this.sliderConfig={"--optical-ratio":{min:1,max:2,step:.01,unit:""},"--line-height":{min:1,max:2,step:.05,unit:""},"--font-size":{min:0,max:2,step:.05,unit:"em"},"--ratio-golden":{min:1,max:2,step:.01,unit:""},"--ratio-silver":{min:1,max:3,step:.01,unit:""},"--ratio-wholestep":{min:1,max:3,step:.01,unit:""},"--ratio-halfstep":{min:1,max:2,step:.01,unit:""},"--font-weight":{min:100,max:900,step:100,unit:""},"--bold-weight":{min:100,max:900,step:100,unit:""},"--radius":{min:0,max:2,step:.05,unit:"rem"},"--line-width":{min:0,max:10,step:.5,unit:"px"},"--base":{min:.5,max:3,step:.05,unit:"rem"},"--base-gap":{min:0,max:3,step:.05,unit:"rem"},"--base-block-gap":{min:0,max:3,step:.05,unit:"rem"},"--body-padding":{min:0,max:5,step:.25,unit:"rem"},"--gap":{min:0,max:3,step:.05,unit:"rem"},"--grid-gap":{min:0,max:3,step:.05,unit:"rem"}},this.coreTokens={typography:["--font-text","--font-header","--font-monospace","--font-interface","--font-size","--optical-ratio","--line-height","--font-weight","--bold-weight","--font-letter-spacing","--font-header-letter-spacing","--font-header-weight"],layout:["--line-width","--line-width-xs","--line-width-s","--line-width-m","--line-width-l","--line-width-xl","--base","--base-gap","--base-block-gap","--body-padding","--gap","--grid-gap"],colors:this.getColorTokens(),advanced:["--ratio-golden","--ratio-silver","--ratio-wholestep","--ratio-halfstep","--radius","--blur","--transition","--line-width","--shadow","--border"]},this.defaults={},this.init()}init(){this.storeDefaults(),this.createBadge(),this.initKeyboardShortcuts(),this.restoreTheme(),this.restoreDebugMode();const e=document.documentElement.getAttribute("data-theme");(document.documentElement.classList.contains("standard-debug")||e==="blueprint")&&this.injectGridDebugOverlays(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",n=>{this.colorScheme=n.matches?"dark":"light",this.state==="full"&&this.refreshTokenList()}),this.initModificationTracking()}restoreTheme(){const e=sessionStorage.getItem("standard-theme");e&&document.documentElement.setAttribute("data-theme",e)}restoreDebugMode(){const e=sessionStorage.getItem("standard-debug-mode");e==="true"?document.documentElement.classList.add("standard-debug"):e==="false"&&document.documentElement.classList.remove("standard-debug")}saveDebugMode(e){sessionStorage.setItem("standard-debug-mode",e.toString())}addTheme(e,t){this.customThemes.some(n=>n.value===e)||(this.customThemes.push({value:e,label:t}),this.state==="quick"&&this.createQuickPanel())}storeDefaults(){[...this.coreTokens.typography,...this.coreTokens.layout,...this.coreTokens.colors,...this.coreTokens.advanced].forEach(t=>{const a=getComputedStyle(document.documentElement).getPropertyValue(t).trim();a&&(this.defaults[t]=a)})}getColorTokens(){const e=this.colorScheme==="light"?"light":"dark";return[`--color-${e}-background`,`--color-${e}-foreground`,`--color-${e}-accent`,`--color-${e}-red`,`--color-${e}-orange`,`--color-${e}-yellow`,`--color-${e}-green`,`--color-${e}-cyan`,`--color-${e}-blue`,`--color-${e}-purple`,`--color-${e}-pink`]}detectColorScheme(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}loadPosition(){const e=localStorage.getItem("standard-lab-position");return e?JSON.parse(e):{bottom:16,right:16}}savePosition(){localStorage.setItem("standard-lab-position",JSON.stringify(this.position))}createBadge(){if(this.badge)return;this.badge=document.createElement("button"),this.badge.id="standard-lab-badge-container",this.badge.className="standard-lab-badge",this.badge.setAttribute("aria-label","Open Standard Inspector"),this.badge.setAttribute("title","Standard Inspector (Shift+Cmd+S)"),this.badge.setAttribute("style","color:var(--color-subtle);"),this.badge.style.bottom=`${this.position.bottom}px`,this.badge.style.right=`${this.position.right}px`,this.badge.innerHTML="",this.badge.addEventListener("click",()=>this.openQuick()),this.makeDraggable(this.badge),(document.getElementById("standard-lab-root")||document.body).appendChild(this.badge),this.updateBadge(),this.injectStyles()}updateBadge(){if(!this.badge)return;const e=this.modifiedTokens.size;e>0?this.badge.setAttribute("data-modified",e):this.badge.removeAttribute("data-modified")}makeDraggable(e){let t=!1,a,n,r,d;const i=p=>{if(p.target!==e&&!e.classList.contains("standard-lab-panel-header"))return;t=!0,a=p.clientX,n=p.clientY;const f=e.getBoundingClientRect();r=window.innerHeight-f.bottom,d=window.innerWidth-f.right,document.addEventListener("mousemove",c),document.addEventListener("mouseup",h),e.style.cursor="grabbing",p.preventDefault()},c=p=>{if(!t)return;const f=a-p.clientX,C=p.clientY-n;this.position.right=Math.max(0,d+f),this.position.bottom=Math.max(0,r-C),e.style.right=`${this.position.right}px`,e.style.bottom=`${this.position.bottom}px`},h=()=>{t=!1,e.style.cursor="",document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",h),this.savePosition()};e.addEventListener("mousedown",i)}openQuick(){if(this.state==="quick"){this.close();return}this.state="quick",this.createQuickPanel()}openFull(){this.state="full",this.createFullPanel()}close(){this.panel&&(this.panel.style.opacity="0",this.panel.style.transform="translateY(10px)",setTimeout(()=>{this.panel&&(this.panel.remove(),this.panel=null)},200)),this.state="dormant"}refresh(){if(console.log("refresh"),this.storeDefaults(),this.badge=null,this.init(),document.documentElement.classList.contains("standard-debug")&&(this.removeGridDebugOverlays(),this.injectGridDebugOverlays()),this.state!=="dormant"){if(this.state==="quick")this.createQuickPanel();else if(this.state==="full"){const e=this.panel?.querySelector('[data-filter="modified"]')?.checked||!1;this.createFullPanel(),this.switchTab(this.currentTab);const t=this.panel?.querySelector('[data-filter="modified"]');t&&(t.checked=e,this.refreshTokenList(e))}}}createQuickPanel(){this.panel&&this.panel.remove(),this.panel=document.createElement("div"),this.panel.id="standard-lab-panel-container",this.panel.className="standard-lab-panel standard-lab-panel-quick",this.panel.style.bottom=`calc(${this.position.bottom}px + var(--base-2))`,this.panel.style.right=`${this.position.right}px`;const e=document.documentElement.classList.contains("standard-debug"),t=this.modifiedTokens.size;this.panel.innerHTML=`
      <header class="standard-lab-panel-header">
          <div>
            <h2>Inspector v${this.version}</h2>
            <div class="standard-lab-viewport-info">${window.innerWidth}px</div>
          </div>
          <button class="standard-lab-btn-icon" data-action="close" title="Close (Esc)">Ã—</button>
        </header>
      <section class="standard-lab-section">
        <label class="standard-lab-toggle">
          <input type="checkbox" ${e?"checked":""} data-toggle="debug">
          <span>Debug Mode</span>
          <kbd>â‡§âŒ˜D</kbd>
        </label>
      </section>
      <section class="standard-lab-section">
        <label class="standard-lab-label">Theme</label>
        <select class="standard-lab-select" data-action="theme">
          ${this.getThemeOptions()}
        </select>
      </section>
      <div class="standard-lab-actions">
        <button class="standard-lab-btn" data-action="edit-tokens">
          ${t>0?`Edit Tokens (${t})`:"Edit Tokens"}
        </button>
        ${t>0?'<button class="standard-lab-btn standard-lab-btn-secondary" data-action="reset">Reset</button>':""}
        <button class="standard-lab-btn standard-lab-btn-secondary" data-action="copy">Copy CSS</button>
      </div>
    `,this.attachQuickPanelListeners(),(document.getElementById("standard-lab-root")||document.body).appendChild(this.panel),requestAnimationFrame(()=>{this.panel.style.opacity="1",this.panel.style.transform="translateY(0)"})}getThemeOptions(){const t=[...[{value:"",label:"Empty"},{value:"default",label:"Default"},{value:"bauhaus",label:"Bauhaus"},{value:"venetian",label:"Venetian"},{value:"newspaper",label:"Newspaper"},{value:"didone",label:"Didone"},{value:"transitional",label:"Transitional"},{value:"english-oldstyle",label:"English Oldstyle"},{value:"paper",label:"Paper"},{value:"swiss",label:"Swiss"},{value:"kernel",label:"Kernel"},{value:"forest",label:"Forest"},{value:"book",label:"Book"},{value:"minimal",label:"Minimal"},{value:"marauder",label:"Marauder"},{value:"blueprint",label:"Blueprint"},{value:"custom_1",label:"Custom 1"},{value:"custom_2",label:"Custom 2"},{value:"custom_3",label:"Custom 3"}],...this.customThemes],a=document.documentElement.getAttribute("data-theme")||"";return t.map(n=>`<option value="${n.value}" ${a===n.value?"selected":""}>${n.label}</option>`).join("")}attachQuickPanelListeners(){this.panel.querySelector('[data-action="close"]')?.addEventListener("click",()=>this.close()),this.panel.querySelector('[data-toggle="debug"]')?.addEventListener("change",e=>{const t=e.target.checked;document.documentElement.classList.toggle("standard-debug",t),this.saveDebugMode(t);const n=document.documentElement.getAttribute("data-theme")==="blueprint";t||n?this.injectGridDebugOverlays():this.removeGridDebugOverlays(),window.toast?.info(`Debug mode ${e.target.checked?"enabled":"disabled"}`)}),this.panel.querySelector('[data-action="theme"]')?.addEventListener("change",e=>{const t=e.target.value;t?document.documentElement.setAttribute("data-theme",t):document.documentElement.removeAttribute("data-theme"),sessionStorage.setItem("standard-theme",t),this.handleBlueprintDebugException(t),window.toast?.info(`Theme: ${t||"Default"}`)}),this.panel.querySelector('[data-action="edit-tokens"]')?.addEventListener("click",()=>this.openFull()),this.panel.querySelector('[data-action="reset"]')?.addEventListener("click",()=>this.resetAll()),this.panel.querySelector('[data-action="copy"]')?.addEventListener("click",()=>this.copyCSS())}handleBlueprintDebugException(e){const t=e==="blueprint",a=document.documentElement.classList.contains("standard-debug");t&&!a?this.injectGridDebugOverlays():!t&&!a&&this.removeGridDebugOverlays()}createFullPanel(){this.panel&&this.panel.remove(),this.panel=document.createElement("div"),this.panel.id="standard-lab-panel-container",this.panel.className="standard-lab-panel standard-lab-panel-full",this.panel.style.bottom=`calc(${this.position.bottom}px + var(--base-2))`,this.panel.style.right=`${this.position.right}px`;const e=this.modifiedTokens.size,t=e>0;this.panel.innerHTML=`
      <header class="standard-lab-panel-header" style="cursor: grab;">
        <h2>Token Editor</h2>
        <div class="standard-lab-header-actions">
          <button class="standard-lab-btn-icon" data-action="minimize" title="Minimize">âˆ’</button>
          <button class="standard-lab-btn-icon" data-action="close" title="Close (Esc)">Ã—</button>
        </div>
      </header>
      <nav class="standard-lab-tabs">
        <button class="standard-lab-tab" data-tab="typography" aria-selected="true">Typography</button>
        <button class="standard-lab-tab" data-tab="layout">Layout</button>
        <button class="standard-lab-tab" data-tab="colors">Colors</button>
        <button class="standard-lab-tab" data-tab="advanced">Advanced</button>
      </nav>
      ${e>0?`<div class="standard-lab-filter"><label class="standard-lab-toggle"><input type="checkbox" ${t?"checked":""} data-filter="modified"><span>Show modified only (${e})</span></label></div>`:""}
      <div class="standard-lab-content">${this.renderTokenList("typography",t)}</div>
      <div class="standard-lab-actions">
        <button class="standard-lab-btn standard-lab-btn-secondary" data-action="reset">Reset All</button>
        <button class="standard-lab-btn" data-action="copy">Copy CSS</button>
      </div>
    `,this.attachFullPanelListeners(),this.makeDraggable(this.panel.querySelector(".standard-lab-panel-header")),(document.getElementById("standard-lab-root")||document.body).appendChild(this.panel),requestAnimationFrame(()=>{this.panel.style.opacity="1",this.panel.style.transform="translateY(0)"})}renderTokenList(e,t=!1){const a=this.coreTokens[e]||[];let n=t?a.filter(r=>this.modifiedTokens.has(r)):a;return n.length===0?'<div class="standard-lab-empty">No tokens to display</div>':`<div class="standard-lab-token-list">${n.map(r=>this.renderTokenRow(r)).join("")}</div>`}isNumericValue(e){return e?/^-?\d+(\.\d+)?(rem|em|px|%|ch|vh|vw)?$/.test(e.trim()):!1}extractNumericValue(e){if(!e)return 0;const t=e.match(/^(-?\d+(\.\d+)?)/);return t?parseFloat(t[1]):0}extractUnit(e){if(!e)return"";const t=e.match(/[a-z%]+$/i);return t?t[0]:""}renderTokenRow(e){const t=this.getPropertyValue(e),a=this.modifiedTokens.has(e),n=e.includes("color")&&this.isColorValue(t),r=this.sliderConfig[e];if(r&&this.isNumericValue(t)){const i=this.extractNumericValue(t);return`
        <div class="standard-lab-token-row ${a?"is-modified":""}">
          <div class="standard-lab-slider-container">
            <label class="standard-lab-slider-label">${e}</label>
            <div class="standard-lab-slider-controls">
              <input
                type="range"
                class="standard-lab-slider-input"
                data-token="${e}"
                value="${i}"
                min="${r.min}"
                max="${r.max}"
                step="${r.step}"
                title="${e}">
              <input
                type="text"
                class="standard-lab-text-input standard-lab-slider-value"
                data-token="${e}"
                value="${t}"
                spellcheck="false">
            </div>
          </div>
          <button class="standard-lab-btn-icon standard-lab-btn-reset" data-action="reset-token" data-token="${e}" title="Reset" ${a?"":"disabled"}>â†º</button>
        </div>
      `}return n?`
        <div class="standard-lab-token-row ${a?"is-modified":""}">
          <div class="standard-lab-color-container">
            <label class="standard-lab-color-label">${e}</label>
            <div class="standard-lab-color-controls">
              <input
                type="color"
                class="standard-lab-color-input"
                data-token="${e}"
                value="${this.extractHexColor(t)}"
                title="Pick color">
              <input
                type="text"
                class="standard-lab-text-input standard-lab-color-value"
                data-token="${e}"
                value="${t}"
                placeholder="${e}"
                spellcheck="false">
            </div>
          </div>
          <button class="standard-lab-btn-icon standard-lab-btn-reset" data-action="reset-token" data-token="${e}" title="Reset" ${a?"":"disabled"}>â†º</button>
        </div>
      `:`
      <div class="standard-lab-token-row ${a?"is-modified":""}">
        <div class="standard-lab-text-container">
          <label class="standard-lab-text-label">${e}</label>
          <input type="text" class="standard-lab-text-input" data-token="${e}" value="${t}" placeholder="${e}" spellcheck="false">
        </div>
        <button class="standard-lab-btn-icon standard-lab-btn-reset" data-action="reset-token" data-token="${e}" title="Reset" ${a?"":"disabled"}>â†º</button>
      </div>
    `}attachFullPanelListeners(){this.panel.querySelector('[data-action="close"]')?.addEventListener("click",()=>this.close()),this.panel.querySelector('[data-action="minimize"]')?.addEventListener("click",()=>this.openQuick()),this.panel.querySelectorAll(".standard-lab-tab").forEach(e=>{e.addEventListener("click",t=>this.switchTab(t.target.dataset.tab))}),this.panel.querySelector('[data-filter="modified"]')?.addEventListener("change",e=>this.refreshTokenList(e.target.checked)),this.panel.querySelectorAll(".standard-lab-slider-input").forEach(e=>{e.addEventListener("input",t=>{const a=t.target.dataset.token,n=t.target.value,d=this.sliderConfig[a].unit||this.extractUnit(this.getPropertyValue(a)),i=`${n}${d}`;this.updateToken(a,i);const c=this.panel.querySelector(`.standard-lab-slider-value[data-token="${a}"]`);c&&(c.value=i)})}),this.panel.querySelectorAll(".standard-lab-slider-value").forEach(e=>{e.addEventListener("input",t=>{const a=t.target.dataset.token,n=t.target.value,r=this.extractNumericValue(n);this.updateToken(a,n);const d=this.panel.querySelector(`.standard-lab-slider-input[data-token="${a}"]`);d&&(d.value=r)})}),this.panel.querySelectorAll(".standard-lab-text-input:not(.standard-lab-slider-value):not(.standard-lab-color-value)").forEach(e=>{e.addEventListener("input",t=>this.updateToken(t.target.dataset.token,t.target.value))}),this.panel.querySelectorAll(".standard-lab-color-input").forEach(e=>{e.addEventListener("input",t=>{const a=t.target.dataset.token,n=t.target.value;this.updateToken(a,n);const r=this.panel.querySelector(`.standard-lab-color-value[data-token="${a}"]`);r&&(r.value=n)})}),this.panel.querySelectorAll(".standard-lab-color-value").forEach(e=>{e.addEventListener("input",t=>{const a=t.target.dataset.token,n=t.target.value;this.updateToken(a,n);const r=this.panel.querySelector(`.standard-lab-color-input[data-token="${a}"]`);r&&this.isColorValue(n)&&(r.value=this.extractHexColor(n))})}),this.panel.querySelectorAll('[data-action="reset-token"]').forEach(e=>{e.addEventListener("click",t=>this.resetToken(t.target.dataset.token))}),this.panel.querySelector('[data-action="reset"]')?.addEventListener("click",()=>this.resetAll()),this.panel.querySelector('[data-action="copy"]')?.addEventListener("click",()=>this.copyCSS())}switchTab(e){this.currentTab=e,this.panel.querySelectorAll(".standard-lab-tab").forEach(a=>{a.setAttribute("aria-selected",a.dataset.tab===e)});const t=this.panel.querySelector('[data-filter="modified"]')?.checked||!1;this.refreshTokenList(t)}refreshTokenList(e=!1){const t=this.panel?.querySelector(".standard-lab-content");t&&(t.innerHTML=this.renderTokenList(this.currentTab,e),this.attachFullPanelListeners())}updateToken(e,t){document.documentElement.style.setProperty(e,t),t!==this.defaults[e]?this.modifiedTokens.add(e):this.modifiedTokens.delete(e),this.updateBadge();const a=this.panel?.querySelector(`[data-action="reset-token"][data-token="${e}"]`);a&&(a.disabled=!this.modifiedTokens.has(e));const n=this.panel?.querySelector(`.standard-lab-token-row:has([data-token="${e}"])`);n&&n.classList.toggle("is-modified",this.modifiedTokens.has(e)),e.includes("font-")&&!e.includes("font-size")&&!e.includes("font-ratio")&&this.loadGoogleFont(t)}resetToken(e){const t=this.defaults[e];if(t){document.documentElement.style.setProperty(e,t),this.modifiedTokens.delete(e);const a=this.panel?.querySelector(`[data-token="${e}"]`);a&&(a.value=t),this.updateBadge(),this.refreshTokenList(),window.toast?.info(`Reset ${e}`)}}resetAll(){confirm("Reset all tokens to defaults?")&&(document.documentElement.removeAttribute("style"),this.modifiedTokens.clear(),this.googleFontsLoaded.clear(),this.updateBadge(),this.state==="full"&&this.refreshTokenList(),window.toast?.info("All tokens reset"))}copyCSS(){const t=`:root {
${[...this.coreTokens.typography,...this.coreTokens.layout,...this.coreTokens.colors,...this.coreTokens.advanced].map(a=>`  ${a}: ${this.getPropertyValue(a)};`).join(`
`)}
}`;navigator.clipboard.writeText(t).then(()=>window.toast?.success("CSS copied to clipboard!")).catch(()=>{const a=document.createElement("textarea");a.value=t,a.style.position="fixed",a.style.opacity="0",document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),window.toast?.success("CSS copied to clipboard!")})}getPropertyValue(e){return getComputedStyle(document.documentElement).getPropertyValue(e).trim()||document.documentElement.style.getPropertyValue(e).trim()}isColorValue(e){return e?e.startsWith("#")||e.startsWith("rgb")||e.startsWith("hsl")||e.startsWith("oklch")||e.includes("color-mix"):!1}extractHexColor(e){if(!e)return"#000000";const t=e.match(/#[0-9a-f]{6}/i);if(t)return t[0];const a=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(a){const[,r,d,i]=a;return"#"+[r,d,i].map(c=>parseInt(c).toString(16).padStart(2,"0")).join("")}return{white:"#ffffff",black:"#000000",red:"#ff0000",green:"#00ff00",blue:"#0000ff",yellow:"#ffff00",orange:"#ffa500",purple:"#800080",pink:"#ffc0cb",cyan:"#00ffff"}[e.toLowerCase()]||"#000000"}loadGoogleFont(e){const t=e.split(",")[0].trim().replace(/['"]/g,"");if(["system-ui","sans-serif","serif","monospace","-apple-system","BlinkMacSystemFont"].includes(t)||this.googleFontsLoaded.has(t))return;const n=`https://fonts.googleapis.com/css2?family=${t.replace(/ /g,"+")}:wght@300;400;500;600;700;900&display=swap`;if(!document.querySelector(`link[href*="${t.replace(/ /g,"+")}"]`)){const r=document.createElement("link");r.rel="stylesheet",r.href=n,document.head.appendChild(r),this.googleFontsLoaded.add(t)}}showNotification(e,t="info"){const a=document.createElement("div");a.className=`standard-lab-notification standard-lab-notification-${t}`,a.textContent=e,document.body.appendChild(a),requestAnimationFrame(()=>{a.style.opacity="1",a.style.transform="translateY(0)"}),setTimeout(()=>{a.style.opacity="0",a.style.transform="translateY(-10px)",setTimeout(()=>a.remove(),200)},2500)}initKeyboardShortcuts(){document.addEventListener("keydown",e=>{const t=navigator.platform.indexOf("Mac")>-1;if(e.shiftKey&&(t?e.metaKey:e.ctrlKey)&&e.key.toLowerCase()==="s"&&(e.preventDefault(),this.state==="dormant"?this.openQuick():this.close()),e.shiftKey&&(t?e.metaKey:e.ctrlKey)&&e.key.toLowerCase()==="d"){e.preventDefault(),document.documentElement.classList.toggle("standard-debug");const a=document.documentElement.classList.contains("standard-debug");this.saveDebugMode(a),a?this.injectGridDebugOverlays():this.removeGridDebugOverlays(),window.toast?.info(`Debug mode ${a?"enabled":"disabled"}`)}e.key==="Escape"&&this.state!=="dormant"&&this.close()})}initModificationTracking(){[...this.coreTokens.typography,...this.coreTokens.layout,...this.coreTokens.colors,...this.coreTokens.advanced].forEach(t=>{const a=this.getPropertyValue(t),n=this.defaults[t];a&&n&&a!==n&&this.modifiedTokens.add(t)}),this.updateBadge()}injectGridDebugOverlays(){document.querySelectorAll(".prose").forEach(t=>{if(t.querySelector(".grid-debug-overlay"))return;const a=document.createElement("div");a.className="grid-debug-overlay",a.setAttribute("aria-hidden","true");for(let n=0;n<7;n++)a.appendChild(document.createElement("span"));t.insertBefore(a,t.firstChild)})}removeGridDebugOverlays(){document.querySelectorAll(".grid-debug-overlay").forEach(e=>e.remove())}injectStyles(){if(document.getElementById("standard-lab-styles"))return;const e=document.createElement("style");e.id="standard-lab-styles",e.textContent=`
      .standard-lab-badge { font-family: var(--font-interface); position: fixed; width: var(--gap); height: var(--gap); border-radius: 50%; background: var(--color-background-accent); border: var(--border-accent); box-shadow: var(--shadow); backdrop-filter: var(--blur); cursor: pointer; z-index: var(--z-toast); line-height:1.5; display: flex; align-items: baseline; justify-content: center; color: var(--color-foreground); transition: all 0.2s ease; padding: 0; }
      .standard-lab-badge:hover { box-shadow: var(--shadow); transform: scale(1.05); color: var(--color-accent); }
      .standard-lab-badge:active { transform: scale(0.95); }
      .standard-lab-badge[data-modified]::after { content: attr(data-modified); position: absolute; top: -4px; right: -4px; width: 20px; height: 20px; border-radius: 50%; background: var(--color-accent); color: var(--color-background); font-size: var(--scale-d3); display: flex; align-items: center; justify-content: center; font-weight: 600; border: 2px solid var(--color-background); }
      .standard-lab-panel { position: fixed; font-size: 16px !important; line-height: 1.2 !important; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important; background: var(--modal-background); backdrop-filter: var(--blur); border: var(--border); border-radius: 6px; box-shadow: var(--shadow); z-index: var(--z-toast); opacity: 0; transform: translateY(10px); transition: opacity 0.2s ease, transform 0.2s ease; display: flex; flex-direction: column; }
      .standard-lab-panel * { font-size: inherit !important; line-height: inherit !important; line-height:1.5 !important; }
      .standard-lab-panel :is(label, input) { margin:0; }
      .standard-lab-panel-quick { max-width: 280px; max-height: 400px; }
      .standard-lab-panel-full { max-width: 360px; max-height: 600px; }
      .standard-lab-panel-header { padding: 6px; border-bottom: var(--border); display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; }
      .standard-lab-panel-header h2 { margin: 0; font-size: 14px !important; font-weight: 600; letter-spacing: -0.02em; }
      .standard-lab-viewport-info { font-size: 11px !important; font-weight: 400; color: var(--color-muted); margin-top: 2px; font-family: var(--font-monospace); }
      .standard-lab-header-actions { display: flex; gap: 6px; }
      .standard-lab-section { padding: 6px; border-bottom: var(--border); }
      .standard-lab-section:last-of-type { border-bottom: none; }
      .standard-lab-label { display: block; font-size: 11px !important; font-weight: 600; color: var(--color-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; }
      .standard-lab-toggle { display: flex; align-items: center; gap: 6px; cursor: pointer; user-select: none; }
      .standard-lab-toggle input[type="checkbox"] { width: 16px; height: 16px; cursor: pointer; margin: 0; }
      .standard-lab-toggle span { flex: 1; font-size: 14px !important; }
      .standard-lab-toggle kbd { font-size: 12px !important; font-family: var(--font-monospace); color: var(--color-subtle); padding: 2px 6px; background: var(--color-background-secondary); border-radius: 6px; }
      .standard-lab-select { width: 100%; padding: 6px 3px; margin:0; background: var(--color-background); border: var(--border); border-radius: 6px; font-size: 14px !important; color: var(--color-foreground); cursor: pointer; }
      .standard-lab-actions { padding: 6px; border-top: var(--border); display: flex; flex-direction: column; gap: 6px; flex-shrink: 0; }
      .standard-lab-btn { font-size: 12px !important; width: 100%; padding: 6px 3px; background: var(--color-accent); color: var(--color-background); border: border-radius: var(--border); border-radius: 6px; font-size: 14px !important; font-weight: 600; cursor: pointer; transition: opacity 0.2s ease; }
      .standard-lab-btn:hover { opacity: 0.9; }
      .standard-lab-btn:active { opacity: 0.8; }
      .standard-lab-btn-secondary { background: var(--color-background-secondary); color: var(--color-foreground); border: var(--border); }
      .standard-lab-btn-icon { font-size: 12px !important; width: 24px; height: 24px; padding: 0; background: transparent; border: none; color: var(--color-muted); font-size: 20px !important; line-height: 1 !important; cursor: pointer; border-radius: 6px; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; }
      .standard-lab-btn-icon:hover { background: var(--color-background-secondary); color: var(--color-foreground); }
      .standard-lab-tabs { display: flex; border-bottom: var(--border); flex-shrink: 0; }
      .standard-lab-tab { flex: 1; padding: 6px; background: transparent; border: none; border-bottom: 2px solid transparent; font-size: 16px !important; font-weight: 500; color: var(--color-muted); cursor: pointer; transition: all 0.2s ease; }
      .standard-lab-tab:hover { color: var(--color-foreground); background: var(--color-background-secondary); }
      .standard-lab-tab[aria-selected="true"] { color: var(--color-foreground); border-bottom-color: var(--color-accent); font-weight: 600; }
      .standard-lab-filter { padding: 6px var(--base-d2); background: var(--color-background-secondary); border-bottom: var(--border); flex-shrink: 0; }
      .standard-lab-content { flex: 1; overflow-y: auto; padding: 6px; }
      .standard-lab-content::-webkit-scrollbar { width: 6px; }
      .standard-lab-content::-webkit-scrollbar-track { background: transparent; }
      .standard-lab-content::-webkit-scrollbar-thumb { background: var(--color-border); border-radius: 6px; }
      .standard-lab-content::-webkit-scrollbar-thumb:hover { background: var(--color-muted); }
      .standard-lab-token-list { display: flex; flex-direction: column; gap: 3px; }
      .standard-lab-token-row { display: grid; grid-template-columns: 1fr auto; gap: 6px; align-items: start; padding: 6px; border-radius: 6px; transition: background 0.2s ease; }
      .standard-lab-token-row:hover { background: var(--color-background-secondary); }
      .standard-lab-token-row.is-modified { background: color-mix(in srgb, var(--color-accent) 5%, transparent); }
      .standard-lab-text-input { padding: 0; background: transparent; border: 1px solid transparent; border-radius: 6px; font-size: 12px !important; font-family: var(--font-monospace); color: var(--color-foreground); min-width: 0; transition: all 0.2s ease; }
      .standard-lab-text-input:focus { outline: none; background: var(--color-background); border-color: var(--color-accent); }
      .standard-lab-color-container { width: 100%; }
      .standard-lab-color-label { display: block; font-size: 11px !important; font-family: var(--font-monospace); color: var(--color-muted); margin-bottom: 6px; }
      .standard-lab-color-controls { display: flex; gap: 6px; align-items: center; }
      .standard-lab-color-input { width: 40px; height: 40px; border: var(--border); border-radius: 6px; cursor: pointer; padding: 4px; background: var(--color-background); flex-shrink: 0; }
      .standard-lab-color-input::-webkit-color-swatch-wrapper { padding: 0; }
      .standard-lab-color-input::-webkit-color-swatch { border: none; border-radius: 6px; }
      .standard-lab-color-value { flex: 1; min-width: 0; padding: 0; font-family: var(--font-monospace); font-size: 12px !important; }
      .standard-lab-text-container { width: 100%; }
      .standard-lab-text-label { display: block; font-size: 11px !important; font-family: var(--font-monospace); color: var(--color-muted); margin-bottom: 6px; }
      .standard-lab-slider-container { width: 100%; }
      .standard-lab-slider-label { display: block; font-size: 11px !important; font-family: var(--font-monospace); color: var(--color-muted); margin-bottom: 6px; }
      .standard-lab-slider-controls { display: flex; gap: 6px; align-items: center; }
      .standard-lab-slider-input { flex: 1; height: 6px; -webkit-appearance: none; appearance: none; background: var(--color-background-secondary); border-radius: 6px; outline: none; cursor: pointer; }
      .standard-lab-slider-input::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 16px; height: 16px; background: var(--color-accent); border-radius: 50%; cursor: grab; transition: transform 0.1s ease; }
      .standard-lab-slider-input::-webkit-slider-thumb:active { cursor: grabbing; transform: scale(1.2); }
      .standard-lab-slider-input::-moz-range-thumb { width: 16px; height: 16px; background: var(--color-accent); border-radius: 50%; border: none; cursor: grab; transition: transform 0.1s ease; }
      .standard-lab-slider-input::-moz-range-thumb:active { cursor: grabbing; transform: scale(1.2); }
      .standard-lab-slider-value { width: 80px; flex-shrink: 0; text-align: center; padding: 6px 8px; font-size: 12px !important; }
      .standard-lab-btn-reset { opacity: 0; transition: opacity 0.2s ease; }
      .standard-lab-token-row:hover .standard-lab-btn-reset:not(:disabled) { opacity: 1; }
      .standard-lab-btn-reset:disabled { opacity: 0; cursor: not-allowed; }
      .standard-lab-empty { padding: var(--base); text-align: center; color: var(--color-subtle); font-size: 14px !important; }
      .standard-lab-notification { position: fixed; top: var(--base); left: 50%; transform: translateX(-50%) translateY(-10px); background: var(--color-background); border: var(--border); border-radius: 6px; padding: 8px 16px; box-shadow: var(--shadow); z-index: calc(var(--z-toast) + 1); font-size: 14px !important; opacity: 0; transition: opacity 0.2s ease, transform 0.2s ease; pointer-events: none; }
      .standard-lab-notification-success { background: var(--color-success); color: white; border-color: var(--color-success); }
      .standard-lab-notification-info { background: var(--color-info); color: white; border-color: var(--color-info); }
      @media (prefers-color-scheme: dark) { .standard-lab-panel { box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3); } }
      @media (max-width: 768px) { .standard-lab-panel-quick, .standard-lab-panel-full { width: calc(100vw - 32px); max-width: 360px; } }
      @media print { .standard-lab-badge, .standard-lab-panel, .standard-lab-notification { display: none !important; } }
    `,document.head.appendChild(e)}}if(typeof window<"u"){const o=()=>{window.StandardLab||(window.StandardLab=new S,console.log("[StandardLab] âœ“ Initialized"))};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o):o(),document.addEventListener("astro:after-swap",()=>{if(console.log("[StandardLab] ðŸ”„ Page swap detected"),!window.StandardLab){console.log("[StandardLab] âš ï¸  Instance not found, reinitializing"),window.StandardLab=new S;return}const e=document.getElementById("standard-lab-root"),t=document.getElementById("standard-lab-badge-container");if(console.log("[StandardLab] Root:",e?"âœ“":"âœ—"),console.log("[StandardLab] Badge:",t?"âœ“":"âœ—"),!e){console.error("[StandardLab] ðŸš¨ Root container missing! Astro may be replacing entire body");return}t||(console.log("[StandardLab] ðŸ”¨ Recreating badge in persistent root"),window.StandardLab.badge=null,window.StandardLab.createBadge()),window.StandardLab.restoreTheme(),window.StandardLab.restoreDebugMode()})}/**
 * Image Zoom - Standalone lightbox with keyboard navigation
 *
 * A lightweight image zoom library with full featured lightbox experience.
 * Click any image to zoom, use arrow keys to navigate, ESC to close.
 *
 * Features:
 * - Click to zoom in/out
 * - Keyboard navigation (â†/â†’ arrows, ESC to close)
 * - Click backdrop to close
 * - Auto-closes on scroll
 * - Wraps around image gallery
 * - Custom events for extensibility
 * - Configurable selectors
 * - Graceful degradation (CSS fallback without JS)
 * - HTMX compatible via rescan() method
 *
 * @version @VERSION_PLACEHOLDER@
 * @license MIT
 */class L{constructor(e={}){this.options={selector:"img:not([data-no-zoom])",enableKeyboardNav:!0,...e},this.overlay=null,this.originalImage=null,this.images=[],this.boundKeydownHandler=this.handleKeydown.bind(this),this.boundCloseHandler=this.close.bind(this),this.init()}init(){document.documentElement.classList.add("js-image-zoom-enabled"),document.addEventListener("click",this.handleClick.bind(this))}rescan(){return this.refreshImages(),console.log(`ImageZoom rescanned. Found ${this.images.length} images.`),this.images.length}refreshImages(){return this.images=Array.from(document.querySelectorAll(this.options.selector)),this.images.length}handleClick(e){const t=e.target.closest(this.options.selector);t&&!this.overlay?(e.preventDefault(),e.stopPropagation(),this.open(t)):this.overlay&&(e.preventDefault(),this.close())}handleKeydown(e){if(this.overlay)switch(e.key){case"Escape":e.preventDefault(),this.close();break;case"ArrowLeft":case"ArrowUp":e.preventDefault(),this.navigate(-1);break;case"ArrowRight":case"ArrowDown":e.preventDefault(),this.navigate(1);break}}open(e){if(this.overlay)return;this.originalImage=e,this.overlay=document.createElement("div"),this.overlay.className="image-zoom-overlay";const t=new Image;t.src=this.originalImage.src,t.alt=this.originalImage.alt,this.overlay.appendChild(t),document.body.appendChild(this.overlay),document.documentElement.classList.add("image-zoomed-active"),this.options.enableKeyboardNav&&document.addEventListener("keydown",this.boundKeydownHandler),window.addEventListener("scroll",this.boundCloseHandler),requestAnimationFrame(()=>{this.overlay.classList.add("is-visible")})}close(){this.overlay&&(window.removeEventListener("scroll",this.boundCloseHandler),this.overlay.classList.remove("is-visible"),this.overlay.addEventListener("transitionend",()=>{this.overlay&&(this.overlay.remove(),this.overlay=null)},{once:!0}),document.documentElement.classList.remove("image-zoomed-active"),this.originalImage=null,this.options.enableKeyboardNav&&document.removeEventListener("keydown",this.boundKeydownHandler))}navigate(e){if(!this.originalImage)return;this.images=Array.from(document.querySelectorAll(this.options.selector));const t=this.images.indexOf(this.originalImage);if(t===-1)return;const a=(t+e+this.images.length)%this.images.length,n=this.images[a];if(n){const r=this.overlay.querySelector("img");r.src=n.src,r.alt=n.alt,this.originalImage=n}}destroy(){this.overlay&&this.close(),document.removeEventListener("click",this.handleClick.bind(this))}}if(typeof window<"u"){window.ImageZoom=L;const o=()=>{window.imageZoom=new L};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o):o()}function u(){if(!navigator.clipboard){console.warn("Clipboard API not available (requires HTTPS)");return}document.querySelectorAll("pre > code").forEach(o=>{if(o.parentNode.querySelector(".copy-button"))return;const e=document.createElement("button");e.className="copy-button",e.textContent="Copy",e.setAttribute("aria-label","Copy code to clipboard"),e.onclick=async()=>{try{await navigator.clipboard.writeText(o.innerText),e.textContent="Copied!",e.classList.add("copied"),setTimeout(()=>{e.textContent="Copy",e.classList.remove("copied")},2e3)}catch(t){console.error("Failed to copy:",t),e.textContent="Failed",setTimeout(()=>{e.textContent="Copy"},2e3)}},o.parentNode.append(e)})}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u());typeof window<"u"&&(window.initCopyButtons=u);function m(o=document){o.querySelectorAll(".scroll:not([data-scroll-initialized])").forEach(t=>{const a=()=>{if(!(t.scrollWidth>t.clientWidth)){t.classList.remove("show-left-shadow","show-right-shadow");return}const r=t.scrollLeft,d=t.scrollWidth-t.clientWidth;t.classList.toggle("show-right-shadow",r===0),t.classList.toggle("show-left-shadow",r>=d-1)};a(),t.addEventListener("scroll",a,{passive:!0}),window.addEventListener("resize",a),t.dataset.scrollInitialized="true"})}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{m(document)}):m(document));typeof window<"u"&&(window.initializeScrollWrappers=m);let b=null,y={x:0,y:0};function A(){typeof document<"u"&&(b=document.documentElement.dataset.theme)}function v(){return typeof window>"u"?!1:"startViewTransition"in document&&(window.transitionEnabledOnThisPage===!0||!("transitionEnabledOnThisPage"in window))}function D(){typeof window>"u"||(document.addEventListener("astro:before-preparation",o=>{const e=document.documentElement.dataset.theme;e&&(b=e)}),document.addEventListener("astro:before-swap",o=>{if(o.newDocument){const e=o.newDocument.documentElement.dataset.theme;e&&(b=e,document.documentElement.dataset.theme=e)}}),document.addEventListener("astro:after-swap",()=>{b&&(document.documentElement.dataset.theme=b)}))}function q(o={}){const{restoreScroll:e=!1}=o;typeof window>"u"||(document.addEventListener("astro:before-preparation",()=>{y={x:window.scrollX||0,y:window.scrollY||0}}),document.addEventListener("astro:after-swap",()=>{e?window.scrollTo(y.x,y.y):window.scrollTo(0,0)}))}function M(){typeof window>"u"||document.addEventListener("astro:after-swap",()=>{window.imageZoom&&typeof window.imageZoom.rescan=="function"&&window.imageZoom.rescan(),typeof m=="function"&&m(document),typeof u=="function"&&u()})}function z(){typeof window>"u"||document.addEventListener("astro:page-load",()=>{window.imageZoom&&typeof window.imageZoom.rescan=="function"&&window.imageZoom.rescan(),typeof m=="function"&&m(document),typeof u=="function"&&u()})}function P(){if(typeof window>"u"||typeof document>"u")return;["astro:before-preparation","astro:after-preparation","astro:before-swap","astro:after-swap","astro:page-load"].forEach(e=>{document.addEventListener(e,t=>{console.log(`[Standard] ${e}`,{type:e,fromURL:t.from?.href||"N/A",toURL:t.to?.href||"N/A",direction:t.direction||"N/A"})})})}function T(o={}){const{usePageLoad:e=!1,debug:t=!1,restoreScroll:a=!1}=o;if(typeof document>"u")return console.warn("[Standard Astro] Document not available - running in non-browser environment"),{success:!1,reason:"non-browser-environment"};const n=v();return t&&console.log("[Standard Astro] Initializing...",{viewTransitionsEnabled:n,usePageLoad:e,restoreScroll:a}),A(),D(),q({restoreScroll:a}),e?(z(),t&&console.log("[Standard Astro] Using astro:page-load event")):(M(),t&&console.log("[Standard Astro] Using astro:after-swap event")),t&&(P(),console.log("[Standard Astro] Debug logging enabled")),t&&console.log("[Standard Astro] âœ“ Initialization complete"),{success:!0,viewTransitionsEnabled:n,modules:["imageZoom","scrollWrappers","copyButtons"]}}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{v()&&T()}):v()&&T());function F(){document.body.addEventListener("htmx:beforeSwap",o=>{const a=new DOMParser().parseFromString(o.detail.xhr.responseText,"text/html").documentElement.dataset.theme;a&&(document.documentElement.dataset.theme=a)})}function H(){document.body.addEventListener("htmx:afterSettle",function(o){window.imageZoom&&window.imageZoom.rescan(),m(o.detail.elt),u()})}function E(){F(),H()}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",E):E());const O={version:"@VERSION_PLACEHOLDER@",getInstance(o){if(typeof window>"u")return null;switch(o){case"toast":return window.toast||null;case"comments":return window.comments||null;case"StandardLab":return window.StandardLab||null;case"imageZoom":return window.imageZoom||null;default:return console.warn(`Unknown module: ${o}. Available: toast, comments, StandardLab, imageZoom`),null}},getInstances(){return typeof window>"u"?{toast:null,comments:null,StandardLab:null,imageZoom:null}:{toast:window.toast||null,comments:window.comments||null,StandardLab:window.StandardLab||null,imageZoom:window.imageZoom||null}},detectFramework(){return typeof window>"u"?"none":window.startViewTransition?"astro-view-transitions":window.astro?"astro":window.htmx?"htmx (deprecated)":"none"},info(){const o=this.detectFramework();console.log(`Standard Framework v${this.version}`),console.log(`Framework detected: ${o}`),console.log("Modules:",["toast - Notification system","comments - GitHub-backed comments","StandardLab - Design token inspector","imageZoom - Click-to-zoom lightbox","initCopyButtons() - Copy buttons for code blocks","initializeScrollWrappers() - Scroll shadows"]),console.log("Integrations:",["âœ“ initAstro() - For Astro View Transitions API (recommended)","âš  initHTMX() - For HTMX navigation (legacy, use View Transitions instead)"]),console.log(`
ðŸ“š Learn more:`),console.log("  Astro View Transitions: https://docs.astro.build/en/guides/view-transitions/")}};typeof window<"u"&&(window.standard=O,console.log("Standard Framework loaded. Type window.standard.info() for help."));

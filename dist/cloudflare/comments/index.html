<!DOCTYPE html><!-- Use Base layout and pass the markdown content through --><html class="rhythm" lang="en" data-theme="default"> <head><meta charset="utf-8"><!-- Standard Framework | https://standard.ffp.co --><title>Standard Framework</title><meta name="description" content="Standard is built on the belief that design systems should be rooted in centuries of typographic tradition, mathematical precision, and the timeless principles of Swiss International Style."><meta name="author" content="Francis Fontaine"><meta name="language" content="en"><meta name="referrer" content="strict-origin-when-cross-origin"><!-- Canonical URL --><link rel="canonical" href="https://standard.ffp.co/cloudflare/comments/"><!-- Feed & Sitemap --><link rel="alternate" type="application/atom+xml" title="Standard Framework" href="https://standard.ffp.co/feed.xml"><link rel="sitemap" type="application/xml" title="Sitemap" href="https://standard.ffp.co/sitemap.xml"><!-- Robots Meta --><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><!-- Open Graph --><meta property="og:title" content="Standard Framework"><meta property="og:type" content="article"><meta property="og:locale" content="en"><meta property="og:site_name" content="Standard Framework"><meta property="og:url" content="https://standard.ffp.co/cloudflare/comments/"><meta property="og:description" content="Standard is built on the belief that design systems should be rooted in centuries of typographic tradition, mathematical precision, and the timeless principles of Swiss International Style."><meta property="og:image" content="https://standard.ffp.co/assets/img/default.png"><meta property="og:image:alt" content="Standard Framework"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><!-- Twitter Cards --><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://standard.ffp.co/assets/img/default.png"><meta name="twitter:image:alt" content="Standard Framework"><meta name="twitter:site" content="@francisfontaine"><meta name="twitter:creator" content="@francisfontaine"><meta name="twitter:title" content="Standard Framework"><meta name="twitter:description" content="Standard is built on the belief that design systems should be rooted in centuries of typographic tradition, mathematical precision, and the timeless principles of Swiss International Style."><!-- Schema.org --><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Standard Framework","description":"Standard is built on the belief that design systems should be rooted in centuries of typographic tradition, mathematical precision, and the timeless principles of Swiss International Style.","author":{"@type":"Person","name":"Francis Fontaine","url":"https://standard.ffp.co/now/"},"publisher":{"@type":"Person","name":"Francis Fontaine","url":"https://standard.ffp.co","logo":{"@type":"ImageObject","url":"https://standard.ffp.co/francis-fontaine-avatar.png"}},"image":{"@type":"ImageObject","url":"https://standard.ffp.co/assets/img/default.png","width":1200,"height":630},"mainEntityOfPage":{"@type":"WebPage","@id":"https://standard.ffp.co/cloudflare/comments/"}}</script><!-- Favicons --><link rel="apple-touch-icon" sizes="180x180" href="https://standard.ffp.co/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://standard.ffp.co/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://standard.ffp.co/favicons/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="https://standard.ffp.co/favicons/safari-pinned-tab.svg" color="#000000"><link rel="shortcut icon" href="https://standard.ffp.co/favicons/favicon.ico"><!-- Mobile --><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)"><!-- Windows Tiles --><meta name="msapplication-TileColor" content="#000000"><meta name="msapplication-config" content="https://standard.ffp.co/favicons/browserconfig.xml"><link rel="preconnect" href="https://rsms.me/"><link rel="stylesheet" href="https://rsms.me/inter/inter.css"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&display=swap" rel="stylesheet"><!-- Standard Framework Lab Features --><script src="/assets/standard/standard.lab.js?v=1764047976404"></script><!-- Load HTMX library --><script type="module" src="/_astro/Base.astro_astro_type_script_index_0_lang.C1onTupY.js"></script><link rel="stylesheet" href="https://use.typekit.net/epz8pgr.css"><!-- âœ… FIX: Load scripts only on client side --><script type="module">
            import "/assets/js/standard.js";
            // import "/assets/js/standard.lab.js"; // Removed - Lab component handles this
            import "/assets/js/standard.toast.js";
            import "/assets/js/standard.comment.js";
        </script><link rel="stylesheet" href="/_astro/_slug_.dcmf1oDl.css"><script type="module" src="/_astro/page.DXhROYzO.js"></script></head> <body hx-boost="true" hx-ext="preload" hx-target="body" hx-swap="innerHTML scroll:window:top" class="prose"> <a href="#main" class="skip-link">Skip to content</a> <header class="flex font-interface" style="justify-content: space-between; max-width: 100%;"> <p> <a href="/" style="text-decoration: none;">Standard Framework</a> </p> <nav class="menu horizontal" aria-label="Navigation"> <ul class="menu"> <li class="menu__item"> <a class="menu__link" href="/docs/"> Docs </a> </li><li class="menu__item"> <a class="menu__link" href="/getting-started/"> Getting Started </a> </li><li class="menu__item"> <a class="menu__link" href="/cheat-sheet/"> Cheat Sheet </a> </li> </ul> </nav> </header> <main id="main" class="prose">  <h1 id="github-comments-system">GitHub Comments System</h1>
<p>AÂ production-ready, serverless comments system forÂ Cloudflare thatÂ stores eachÂ comment as aÂ JSON file directly inÂ your GitHubÂ repository.</p>
<h2 id="quick-navigation">Quick Navigation</h2>
<ul>
<li><strong><a href="./COMMENTS-QUICK-START.md" preload="" hx-boost="true">QuickÂ Start</a></strong> â€” 10-minute setupÂ guide</li>
<li><strong><a href="./COMMENTS-GUIDE.md" preload="" hx-boost="true">FullÂ Guide</a></strong> â€” CompleteÂ documentation</li>
<li><strong><a href="./COMMENTS-FILES.md" preload="" hx-boost="true">FileÂ Reference</a></strong> â€” File directory andÂ details</li>
<li><strong><a href="./comments-template.html" preload="" hx-boost="true">HTMLÂ Template</a></strong> â€” Ready-to-use formÂ HTML</li>
</ul>
<h2 id="howitworks">HowÂ ItÂ Works</h2>
<pre class="language-plaintext" data-language="plaintext"><code is:raw="" class="language-plaintext">User submits comment on page with URL /blog/my-post/
    â†“
Page URL normalized to "blog--my-post" (safe file path)
    â†“
Cloudflare validates &#x26; sanitizes
    â†“
Spam detection checks
    â†“
Comment stored as Markdown file in GitHub
    â†“
Browser fetches &#x26; renders with threading
</code></pre>
<h2 id="page-id-system">Page ID System</h2>
<p>Comments areÂ associated withÂ <strong>pageÂ URLs</strong> (notÂ filenames):</p>
<ul>
<li><strong>URL</strong>: <code>/blog/my-post/</code> â†’ <strong>PageÂ ID</strong>: <code>blogâ€“my-post</code></li>
<li><strong>URL</strong>: <code>/about/</code> â†’ <strong>PageÂ ID</strong>: <code>about</code></li>
<li><strong>URL</strong>: <code>/</code> â†’ <strong>PageÂ ID</strong>: <code>index</code></li>
<li><strong>URL</strong>: <code>/blog/2024/article/</code> â†’ <strong>PageÂ ID</strong>: <code>blogâ€“2024â€“article</code></li>
</ul>
<p><strong>WhyÂ URLs?</strong> ThisÂ ensures comments follow theÂ content ifÂ you rename files butÂ keep URLs stable viaÂ permalinks.</p>
<h2 id="key-features">Key Features</h2>
<p>âœ… <strong>OwnÂ YourÂ Data</strong> â€” Comments stored inÂ GitHub, not third-party services âœ… <strong>SpamÂ Detection</strong> â€” Automatic detection withÂ configurable thresholds âœ… <strong>Moderation</strong> â€” Email alerts + approval workflow âœ… <strong>NestedÂ Replies</strong> â€” Threaded comments withÂ visual hierarchy âœ… <strong>Markdown</strong> â€” Support forÂ <strong>bold</strong>, <em>italic</em>, <code>code</code>, <a href="url" preload="" hx-boost="true">links</a> âœ… <strong>ZeroÂ Dependencies</strong> â€” Pure JavaScript, noÂ npm packages âœ… <strong>Responsive</strong> â€” Mobile-friendly design âœ… <strong>XSSÂ Safe</strong> â€” HTML sanitization + entityÂ encoding</p>
<h2 id="files-included">Files Included</h2>
<p><strong>SourceÂ Code</strong> (inÂ <code>src/cloudflare/</code>):</p>
<ul>
<li><code>comments.js</code> â€” Server-side handler (400Â lines)</li>
<li><code>standard.comment.js</code> â€” Browser library (350Â lines)</li>
<li><code>comments-example.js</code> â€” Ready-to-deployÂ endpoint</li>
<li><code>wrangler-comments.toml.template</code> â€” CloudflareÂ config</li>
</ul>
<p><strong>Documentation</strong> (inÂ <code>content/cloudflare/comments/</code>):</p>
<ul>
<li><code>COMMENTS-QUICK-START.md</code> â€” 10-minuteÂ setup</li>
<li><code>COMMENTS-GUIDE.md</code> â€” CompleteÂ documentation</li>
<li><code>COMMENTS-FILES.md</code> â€” FileÂ reference</li>
<li><code>comments-template.html</code> â€” HTML + CSSÂ template</li>
</ul>
<h2 id="3-minute-overview">3-Minute Overview</h2>
<h3 id="1-github-setup">1. GitHub Setup</h3>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token comment"># Generate personal access token (repoÂ scope)</span>
<span class="token comment">#Â Â§Â§URLÂ§Â§23Â§Â§</span>

<span class="token comment"># Create commentsÂ directory</span>
<span class="token function">mkdir</span> data/comments
<span class="token function">git</span> <span class="token function">add</span> data/comments/.gitkeep
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">â€œAdd commentsÂ directoryâ€</span>
<span class="token function">git</span> push
</code></pre>
<h3 id="2-cloudflare-deployment">2. Cloudflare Deployment</h3>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token comment"># Deploy commentsÂ function</span>
wrangler publish <span class="token parameter variable">â€“env</span> production

<span class="token comment"># Set GitHubÂ token</span>
wrangler secret put GITHUB_TOKEN <span class="token parameter variable">â€“env</span> production
</code></pre>
<h3 id="3-frontend-integration">3. Frontend Integration</h3>
<pre class="language-html" data-language="html"><code is:raw="" class="language-html"><span class="token comment">&#x3C;!â€“ Add toÂ your pageÂ â€“></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>comments<span class="token punctuation">â€œ</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>comment-form<span class="token punctuation">â€œ</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>text<span class="token punctuation">â€œ</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>author<span class="token punctuation">â€œ</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>Name<span class="token punctuation">â€œ</span></span> <span class="token attr-name">required</span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>email<span class="token punctuation">â€œ</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>email<span class="token punctuation">â€œ</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>Email<span class="token punctuation">â€œ</span></span> <span class="token attr-name">required</span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>content<span class="token punctuation">â€œ</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>Comment<span class="token punctuation">â€œ</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>textarea</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>submit<span class="token punctuation">â€œ</span></span><span class="token punctuation">></span></span>Post<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>form</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">â€œ</span>/path/to/standard.comment.js<span class="token punctuation">â€œ</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">const</span> comments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GitHubComments</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">apiUrl</span><span class="token operator">:</span> <span class="token string">'/api/commentsâ€™</span><span class="token punctuation">,</span>
    <span class="token literal-property property">pageId</span><span class="token operator">:</span> <span class="token string">â€˜blog/my-postâ€™</span><span class="token punctuation">,</span>
    <span class="token literal-property property">container</span><span class="token operator">:</span> <span class="token string">'#commentsâ€™</span><span class="token punctuation">,</span>
    <span class="token literal-property property">form</span><span class="token operator">:</span> <span class="token string">'#comment-form'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> comments<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> comments<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> comments<span class="token punctuation">.</span><span class="token function">attachFormHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h2 id="file-structure">File Structure</h2>
<p>After deployment, your repo willÂ have:</p>
<pre class="language-plaintext" data-language="plaintext"><code is:raw="" class="language-plaintext">data/comments/
â”œâ”€â”€ blog--my-post/
â”‚   â”œâ”€â”€ 1729609945000-a7x9k2m1.md
â”‚   â”œâ”€â”€ 1729609967000-b4z2k9p3.md
â”‚   â””â”€â”€ 1729610005000-c8m5l1q7.md
â”œâ”€â”€ about/
â”‚   â””â”€â”€ 1729610045000-e9m2k7p5.md
â””â”€â”€ index/
    â””â”€â”€ 1729610100000-d2m8k4r9.md
</code></pre>
<p><strong>Note</strong>: Directory names use normalized page IDs (slashes replaced withÂ <code>â€“</code>).</p>
<p>EachÂ comment: ~500â€“1,000 bytes (small,Â git-friendly)</p>
<h2 id="api-endpoints">API Endpoints</h2>
<h3 id="post-apicomments">POST /api/comments</h3>
<p>Submit aÂ newÂ comment</p>
<pre class="language-json" data-language="json"><code is:raw="" class="language-json"><span class="token punctuation">{</span>
  <span class="token property">â€œpageIdâ€</span><span class="token operator">:</span> <span class="token string">â€œblogâ€“my-postâ€</span><span class="token punctuation">,</span>
  <span class="token property">â€œauthorâ€</span><span class="token operator">:</span> <span class="token string">â€œJohnÂ Doeâ€</span><span class="token punctuation">,</span>
  <span class="token property">â€œemailâ€</span><span class="token operator">:</span> <span class="token string">â€œÂ§Â§EMAILÂ§Â§24Â§Â§â€</span><span class="token punctuation">,</span>
  <span class="token property">â€œcontentâ€</span><span class="token operator">:</span> <span class="token string">â€œGreatÂ article!â€</span><span class="token punctuation">,</span>
  <span class="token property">â€œparentIdâ€</span><span class="token operator">:</span> <span class="token null keyword">null</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Note</strong>: <code>pageId</code> shouldÂ beÂ normalized (e.g., <code>blogâ€“my-post</code> not <code>blog/my-post</code>). TheÂ â€œ shortcode handles thisÂ automatically.</p>
<h3 id="get-apicommentspageidblogmy-post">GET /api/comments?pageId=blogâ€”my-post</h3>
<p>Fetch allÂ comments forÂ aÂ page</p>
<pre class="language-json" data-language="json"><code is:raw="" class="language-json"><span class="token punctuation">{</span>
  <span class="token property">â€œpageIdâ€</span><span class="token operator">:</span> <span class="token string">â€œblogâ€“my-postâ€</span><span class="token punctuation">,</span>
  <span class="token property">â€œcountâ€</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token property">â€œcommentsâ€</span><span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="configuration">Configuration</h2>
<h3 id="11ty-plugin-configuration">11ty Plugin Configuration</h3>
<p>Configure theÂ comments system inÂ your <code>eleventy.config.js</code>:</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript"><span class="token keyword">import</span> Standard <span class="token keyword">from</span> <span class="token string">â€œ@zefish/standardâ€</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">eleventyConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  eleventyConfig<span class="token punctuation">.</span><span class="token function">addPlugin</span><span class="token punctuation">(</span>Standard<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">comments</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">enabled</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">apiEndpoint</span><span class="token operator">:</span> <span class="token string">â€œ/api/commentsâ€</span><span class="token punctuation">,</span>
      <span class="token literal-property property">commentsPath</span><span class="token operator">:</span> <span class="token string">â€œdata/commentsâ€</span>  <span class="token comment">// â† Configurable GitHub storageÂ path</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Options</strong>:</p>
<ul>
<li><code>enabled</code> (boolean) â€” Enable/disable commentsÂ system</li>
<li><code>apiEndpoint</code> (string) â€” API endpoint path (default: <code>/api/comments</code>)</li>
<li><code>commentsPath</code> (string) â€” GitHub storage path (default: <code>data/comments</code>)</li>
</ul>
<h3 id="cloudflare-environment-variables">Cloudflare Environment Variables</h3>
<p>Required environmentÂ variables:</p>
<ul>
<li><code>GITHUB_TOKEN</code> â€” Personal access token withÂ repo writeÂ access</li>
<li><code>GITHUB_OWNER</code> â€” Your GitHubÂ username</li>
<li><code>GITHUB_REPO</code> â€” RepositoryÂ name</li>
<li><code>GITHUB_COMMENTS_PATH</code> â€” Path forÂ comments (default: <code>data/comments</code>, mustÂ match <code>commentsPath</code>Â above)</li>
</ul>
<p>Optional:</p>
<ul>
<li><code>MODERATION_EMAIL</code> â€” Email forÂ spamÂ alerts</li>
<li><code>SPAM_CHECK_ENABLED</code> â€” Enable spam detection (default:Â true)</li>
</ul>
<p><strong>Example</strong>: ToÂ store comments inÂ <code>comments/</code> instead ofÂ <code>data/comments/</code>:</p>
<ol>
<li>Set <code>commentsPath:Â â€œcommentsâ€</code> inÂ your 11tyÂ config</li>
<li>Set <code>GITHUB_COMMENTS_PATH=comments</code> inÂ Cloudflare environmentÂ variables</li>
<li>Create <code>comments/</code> directory inÂ your GitHubÂ repo</li>
</ol>
<h2 id="use-cases">Use Cases</h2>
<p>PerfectÂ for:</p>
<ul>
<li>ğŸ“ Static site blogs (11ty, Hugo,Â Jekyll)</li>
<li>ğŸ“š DocumentationÂ sites</li>
<li>ğŸ¨ PortfolioÂ projects</li>
<li>ğŸ“° News/announcementÂ boards</li>
<li>ğŸ’¡ ProductÂ feedback</li>
<li>ğŸ—¨ï¸ CommunityÂ discussions</li>
</ul>
<h2 id="security">Security</h2>
<p>âœ… HTML sanitization (removes XSS) âœ… Email validation âœ… GitHub token inÂ secrets (never exposed) âœ… Spam detection withÂ confidence scoring âœ… Rate limiting support âœ… Moderation approvalÂ workflow</p>
<h2 id="next-steps">Next Steps</h2>
<ol>
<li><strong><a href="./COMMENTS-QUICK-START.md" preload="" hx-boost="true">Start withÂ Quick StartÂ Guide</a></strong> (10Â minutes)</li>
<li>Set upÂ GitHub personal accessÂ token</li>
<li>Deploy toÂ Cloudflare</li>
<li>Add HTML form toÂ yourÂ page</li>
<li>Test commentÂ submission</li>
<li>Monitor moderationÂ queue</li>
</ol>
<h2 id="advantages">Advantages</h2>
<p><strong>vs. Third-partyÂ Services</strong> (Disqus,Â Commento):</p>
<ul>
<li>âœ… OwnÂ yourÂ data</li>
<li>âœ… NoÂ externalÂ dependencies</li>
<li>âœ… Free (uses existingÂ services)</li>
<li>âœ… Full control &#x26;Â transparency</li>
<li>âœ… Built-inÂ GitHubÂ workflow</li>
</ul>
<p><strong>vs. DatabaseÂ Solutions</strong> (MongoDB,Â PostgreSQL):</p>
<ul>
<li>âœ… NoÂ databaseÂ maintenance</li>
<li>âœ… Version control &#x26; historyÂ (git)</li>
<li>âœ… GitHub moderationÂ interface</li>
<li>âœ… AutomaticÂ scaling</li>
<li>âœ… Built-inÂ backups</li>
</ul>
<h2 id="breaking-changes-v01053">Breaking Changes (v0.10.53+)</h2>
<h3 id="page-ids-nowuse-pageurl-not-pagefileslug">Page IDs NowÂ Use <code>page.url</code> (Not <code>page.fileSlug</code>)</h3>
<p>Comments areÂ nowÂ associated withÂ <strong>pageÂ URLs</strong> instead ofÂ <strong>fileÂ names</strong>.</p>
<p><strong>Why?</strong> ThisÂ ensures comments follow theÂ content ifÂ you rename files butÂ keep URLs stable viaÂ permalinks.</p>
<p><strong>Migration</strong>: Not backward compatible. IfÂ you have existing comments fromÂ earlier versions, they used <code>page.fileSlug</code>. TheÂ system wonâ€™t automatically find them withÂ theÂ new URL-basedÂ IDs.</p>
<p><strong>Options</strong>:</p>
<ol>
<li><strong>Accept freshÂ start</strong> â€” Existing comments stay inÂ old directories (wonâ€™t display), new comments use newÂ structure</li>
<li><strong>Donâ€™tÂ upgrade</strong> â€” Stay onÂ earlier version ifÂ you have existing comments you want toÂ keep</li>
<li><strong>ManualÂ migration</strong> â€” Rename directories toÂ match new URL-based IDs (seeÂ below)</li>
</ol>
<h3 id="configurable-comments-path">Configurable Comments Path</h3>
<p>TheÂ comments storage path isÂ nowÂ configurable (previously hardcoded toÂ <code>data/comments</code>).</p>
<p><strong>WhatÂ Changed</strong>:</p>
<ul>
<li><strong>Before</strong>: Always <code>data/comments/</code></li>
<li><strong>After</strong>: Configurable via <code>commentsPath</code> option (default: <code>data/comments</code>)</li>
</ul>
<p><strong>ActionÂ Required</strong>: Set <code>GITHUB_COMMENTS_PATH</code> environment variable inÂ Cloudflare toÂ match your chosenÂ path.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p><strong>Comments notÂ appearing?</strong></p>
<ul>
<li>Check Cloudflare function logs: <code>wrangler tail â€“envÂ production</code></li>
<li>Verify GitHub token hasÂ <code>repo</code>Â scope</li>
<li>Confirm <code>GITHUB_COMMENTS_PATH</code>Â exists</li>
<li>Verify <code>pageId</code> isÂ normalized (use browser console toÂ check)</li>
</ul>
<p><strong>GitHub 401Â Unauthorized?</strong></p>
<ul>
<li>Token expired orÂ incorrect</li>
<li>Regenerate token withÂ properÂ scope</li>
</ul>
<p><strong>Spam tooÂ aggressive?</strong></p>
<ul>
<li>Adjust detection inÂ <code>comments.js</code></li>
<li>Lower confidenceÂ threshold</li>
<li>Disable: <code>SPAM_CHECK_ENABLED =Â â€œfalseâ€</code></li>
</ul>
<p><strong>WrongÂ pageId?</strong></p>
<ul>
<li>Check browser console forÂ actual <code>pageId</code>Â value</li>
<li>ShouldÂ beÂ normalized (e.g., <code>blogâ€“my-post</code> not <code>blog/my-post</code>)</li>
<li>IfÂ manual integration, ensure you normalize URLsÂ yourself</li>
</ul>
<p>See <a href="./COMMENTS-GUIDE.md" preload="" hx-boost="true">COMMENTS-GUIDE.md</a> forÂ moreÂ troubleshooting.</p>
<h2 id="statistics">Statistics</h2>
<ul>
<li><strong>TotalÂ Size</strong>: ~65 KB (allÂ files)</li>
<li><strong>Code</strong>: ~800Â lines</li>
<li><strong>Documentation</strong>: ~900Â lines</li>
<li><strong>Dependencies</strong>: 0Â (zero!)</li>
<li><strong>BrowserÂ Support</strong>: AllÂ modern browsersÂ (ES6+)</li>
</ul>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="../index.md" preload="" hx-boost="true">CloudflareÂ Workers</a> â€” General CloudflareÂ setup</li>
<li><a href="./../../css/utilities.md" preload="" hx-boost="true">Utilities</a> â€” CSS utilities forÂ stylingÂ comments</li>
<li><a href="./../../index.md" preload="" hx-boost="true">StandardÂ Framework</a> â€” Main frameworkÂ documentation</li>
</ul>
<p><strong>Version</strong>: 0.10.53 <strong>Status</strong>: âœ… Production Ready <strong>LastÂ Updated</strong>: OctoberÂ 2024</p>  <article class="comments-system"> <div id="comments"></div> <button id="show-comment-form-btn" type="button" class="button" onclick="document.getElementById('comment-form-wrapper').style.display='block'; this.style.display='none';">
Write a Comment
</button> <div id="comment-form-wrapper" style="display: none;"> <form id="comment-form" method="post" action="/api/comments" novalidate> <fieldset> <legend>Leave a Comment</legend> <label for="author">Your Name <span aria-label="required">*</span></label> <input type="text" id="author" name="author" placeholder="Your name will be displayed with your comment." required maxlength="100"> <label for="email">Email Address <span aria-label="required">*</span></label> <input type="email" id="email" name="email" placeholder="Your email will not be displayed publicly." required> <label for="content">Comment <span aria-label="required">*</span></label> <textarea id="content" name="content" placeholder="Share your thoughts... Supports **bold**, *italic*, `code`, and [links](url)" required minlength="3" maxlength="10000" rows="6"></textarea> <!-- Hidden fields --> <input type="hidden" id="pageId" name="pageId" value="cloudflare_comments"> <input type="hidden" id="parentId" name="parentId" value=""> <!-- Status indicator --> <div id="form-status" role="status" aria-live="polite"></div> <!-- Submit buttons --> <div class="form-actions"> <button type="submit" class="button">Post Comment</button>   </div> </fieldset> </form> </div> </article> <script defer>(function(){const initOptions = {"apiUrl":"/api/comments","pageId":"cloudflare_comments","container":"#comments","form":"#comment-form","pollInterval":null};

  document.addEventListener("DOMContentLoaded", async () => {
    // Assuming GitHubComments is loaded globally or imported. 
    // Since the original used a global script, we might need to import it here or assume it's available.
    // For now, we'll assume the user includes the standard.comment.js script separately or we should import it.
    // But standard.comment.js is in dist/.
    
    if (typeof GitHubComments !== 'undefined') {
      const comments = new GitHubComments(initOptions);
      try {
        await comments.load();
        comments.render();
      } catch (error) {
        console.error("Error loading comments:", error);
        const container = document.querySelector("#comments");
        if (container) container.innerHTML = '<p class="error">Failed to load comments. Please try again later.</p>';
      }
      comments.attachFormHandler();
    }
  });
})();</script> </main> <hr> <footer class="smaller font-interface"> <p>
Â© 2025 Francis Fontaine Â·
<a href="/">Standard Framework</a> Â·
<a href="https://github.com/ZeFish/Standard/blob/main/LICENSE" class="external-link">MIT License</a> </p> </footer> </body></html>
/**!
 * Standard System Debug & Playground Tool
 *
 * A minimalist debug interface for the Standard Framework
 * Opens with Shift+Cmd+D (Mac) or Shift+Ctrl+D (Windows/Linux)
 *
 * Philosophy: Form follows function. Every control serves a purpose.
 * Inspired by the clarity of Swiss design and Dieter Rams' interface principles.
 *
 * @version Standard Framework v0.11.22 | 2025-10-23T19:45:06.924Z
 */
class StandardLab{constructor(){this.isOpen=false;this.panel=null;this.googleFontsLoaded=new Set;this.colorScheme=this.detectColorScheme();this.coreTokens={typography:["--font-text","--font-header","--font-interface","--font-monospace","--font-feature","--font-variation","--font-header-feature","--font-header-variation","--font-monospace-feature","--font-monospace-variation","--font-size","--font-ratio","--font-density","--font-letter-spacing"],layout:["--line-width","--rhythm-multiplier"],colorsLight:["--color-light-background","--color-light-foreground","--color-light-red","--color-light-orange","--color-light-yellow","--color-light-green","--color-light-cyan","--color-light-blue","--color-light-purple","--color-light-pink","--color-light-accent"],colorsDark:["--color-dark-background","--color-dark-foreground","--color-dark-red","--color-dark-orange","--color-dark-yellow","--color-dark-green","--color-dark-cyan","--color-dark-blue","--color-dark-purple","--color-dark-pink","--color-dark-accent"]};this.shortcut={shift:true,meta:navigator.platform.indexOf("Mac")>-1,ctrl:navigator.platform.indexOf("Mac")===-1,key:"d"};this.init()}init(){document.addEventListener("keydown",e=>{const matchesMac=this.shortcut.meta&&e.shiftKey&&e.metaKey&&e.key===this.shortcut.key;const matchesWin=this.shortcut.ctrl&&e.shiftKey&&e.ctrlKey&&e.key===this.shortcut.key;if(matchesMac||matchesWin){e.preventDefault();this.toggle()}});document.addEventListener("keydown",e=>{const isMac=navigator.platform.indexOf("Mac")>-1;const matchesMac=isMac&&e.shiftKey&&e.metaKey&&e.key.toLowerCase()==="s";const matchesWin=!isMac&&e.shiftKey&&e.ctrlKey&&e.key.toLowerCase()==="s";if(matchesMac||matchesWin){e.preventDefault();document.body.classList.toggle("standard-debug");const isActive=document.body.classList.contains("standard-debug");this.showDebugToggleNotification(isActive);if(this.isOpen){this.updateDebugIndicator()}}});document.addEventListener("keydown",e=>{if(e.key==="Escape"&&this.isOpen){this.close()}});if(window.matchMedia){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{this.colorScheme=e.matches?"dark":"light";if(this.isOpen){this.refreshPanel()}})}}detectColorScheme(){if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches){return"dark"}return"light"}toggle(){if(this.isOpen){this.close()}else{this.open()}}open(){if(this.panel){this.panel.remove()}this.isOpen=true;this.createPanel();document.body.appendChild(this.panel);requestAnimationFrame(()=>{this.panel.style.opacity="1";this.panel.style.transform="translateX(0)"})}close(){if(!this.panel)return;this.isOpen=false;this.panel.style.opacity="0";this.panel.style.transform="translateX(100%)";setTimeout(()=>{if(this.panel){this.panel.remove();this.panel=null}},200)}refreshPanel(){if(!this.panel)return;const content=this.panel.querySelector(".system-content");if(content){this.updateColorSchemeIndicator();content.innerHTML=`\n        ${this.createSection("Typography",this.coreTokens.typography)}\n        ${this.createSection("Layout & Rhythm",this.coreTokens.layout)}\n        ${this.colorScheme==="light"?this.createSection("Colors (Light Mode)",this.coreTokens.colorsLight,true):this.createSection("Colors (Dark Mode)",this.coreTokens.colorsDark,true)}\n      `;this.attachInputListeners()}}createPanel(){this.panel=document.createElement("div");this.panel.className="standard-system-panel";const colorSection=this.colorScheme==="light"?this.createSection("Colors (Light Mode)",this.coreTokens.colorsLight,true):this.createSection("Colors (Dark Mode)",this.coreTokens.colorsDark,true);this.panel.innerHTML=`\n      <div class="system-header">\n        <div class="system-title-group">\n          <h2>Standard System</h2>\n          <span class="system-color-scheme" data-scheme="${this.colorScheme}">${this.colorScheme} mode</span>\n        </div>\n        <div class="system-actions">\n          <button class="system-btn" data-action="toggle-debug" title="Toggle Debug Mode">\n            <span class="system-indicator"></span>\n            Debug\n          </button>\n          <button class="system-btn system-btn-primary" data-action="copy-all" title="Copy All as CSS">\n            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>\n              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>\n            </svg>\n            Copy CSS\n          </button>\n          <button class="system-btn" data-action="reset" title="Reset All Values">Reset</button>\n          <button class="system-btn system-close" data-action="close" title="Close (Esc)">×</button>\n        </div>\n      </div>\n      <div class="system-content">\n        ${this.createSection("Typography",this.coreTokens.typography)}\n        ${this.createSection("Layout & Rhythm",this.coreTokens.layout)}\n        ${colorSection}\n      </div>\n      <div class="system-footer">\n        <span class="system-shortcut">Shift+${this.shortcut.meta?"Cmd":"Ctrl"}+D to toggle</span>\n      </div>\n    `;this.attachEventListeners();this.updateDebugIndicator();this.injectStyles()}getPropertyValue(token){const value=getComputedStyle(document.documentElement).getPropertyValue(token).trim();if(!value){return document.documentElement.style.getPropertyValue(token).trim()}return value}createSection(title,tokens,useColorPicker=false){if(!tokens||tokens.length===0)return"";const rows=tokens.map(token=>{let value=this.getPropertyValue(token);if(!value){value=""}const isColor=useColorPicker||token.includes("color")&&this.isColorValue(value);const isFont=token.includes("font-")&&!token.includes("font-size")&&!token.includes("font-ratio")&&!token.includes("font-density")&&!token.includes("font-letter")&&!token.includes("font-feature")&&!token.includes("font-variation");return`\n        <div class="system-row">\n          <label class="system-label" title="${token}">\n            <span class="system-token">${token.replace("--","").replace("color-light-","").replace("color-dark-","")}</span>\n          </label>\n          <div class="system-input-group">\n            ${isColor?this.createColorInput(token,value):this.createTextInput(token,value,isFont)}\n          </div>\n        </div>\n      `}).join("");return`\n      <details class="system-section" open>\n        <summary class="system-section-title">${title}</summary>\n        <div class="system-section-content">\n          ${rows}\n        </div>\n      </details>\n    `}createColorInput(token,value){const hexColor=this.extractHexColor(value);return`\n      <div class="system-color-input">\n        <input\n          type="color"\n          class="system-input-color"\n          data-token="${token}"\n          value="${hexColor}"\n          title="Pick color"\n        >\n        <input\n          type="text"\n          class="system-input-text"\n          data-token="${token}"\n          value="${value}"\n          placeholder="${value||"Enter color value"}"\n        >\n      </div>\n    `}createTextInput(token,value,isFont=false){return`\n      <input\n        type="text"\n        class="system-input-text ${isFont?"system-input-font":""}"\n        data-token="${token}"\n        data-is-font="${isFont}"\n        value="${value}"\n        placeholder="${value||"Enter value"}"\n      >\n    `}isColorValue(value){if(!value)return false;return value.startsWith("#")||value.startsWith("rgb")||value.startsWith("hsl")||value.includes("color-mix")||["white","black","red","green","blue","yellow","orange","purple","pink","cyan","transparent"].includes(value.toLowerCase())}extractHexColor(value){if(!value)return"#000000";const hexMatch=value.match(/#[0-9a-f]{6}/i);if(hexMatch)return hexMatch[0];const rgbMatch=value.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(rgbMatch){const[,r,g,b]=rgbMatch;return"#"+[r,g,b].map(x=>parseInt(x).toString(16).padStart(2,"0")).join("")}const colorMap={white:"#ffffff",black:"#000000",red:"#ff0000",green:"#00ff00",blue:"#0000ff",yellow:"#ffff00",orange:"#ffa500",purple:"#800080",pink:"#ffc0cb",cyan:"#00ffff"};return colorMap[value.toLowerCase()]||"#000000"}loadGoogleFont(fontName){const cleanName=fontName.split(",")[0].trim().replace(/['"]/g,"");const systemFonts=["system-ui","sans-serif","serif","monospace","-apple-system","BlinkMacSystemFont"];if(systemFonts.includes(cleanName))return;if(this.googleFontsLoaded.has(cleanName))return;const fontUrl=`https://fonts.googleapis.com/css2?family=${cleanName.replace(/ /g,"+")}:wght@300;400;500;600;700;900&display=swap`;if(!document.querySelector(`link[href*="${cleanName.replace(/ /g,"+")}"]`)){const link=document.createElement("link");link.rel="stylesheet";link.href=fontUrl;document.head.appendChild(link);this.googleFontsLoaded.add(cleanName);this.showNotification(`Loading ${cleanName} from Google Fonts...`)}}generateCSS(){const allTokens=[...this.coreTokens.typography,...this.coreTokens.layout,...this.coreTokens.colorsLight,...this.coreTokens.colorsDark];const cssLines=allTokens.map(token=>{const value=this.getPropertyValue(token);return`  ${token}: ${value};`});return`:root {\n${cssLines.join("\n")}\n}`}copyAllCSS(){const css=this.generateCSS();navigator.clipboard.writeText(css).then(()=>{this.showNotification("✓ CSS copied to clipboard!","success")}).catch(()=>{const textarea=document.createElement("textarea");textarea.value=css;textarea.style.position="fixed";textarea.style.opacity="0";document.body.appendChild(textarea);textarea.select();document.execCommand("copy");document.body.removeChild(textarea);this.showNotification("✓ CSS copied to clipboard!","success")})}showNotification(message,type="info"){const notification=document.createElement("div");notification.className=`system-notification system-notification-${type}`;notification.textContent=message;this.panel.appendChild(notification);requestAnimationFrame(()=>{notification.style.opacity="1";notification.style.transform="translateY(0)"});setTimeout(()=>{notification.style.opacity="0";notification.style.transform="translateY(-10px)";setTimeout(()=>notification.remove(),200)},2500)}updateColorSchemeIndicator(){const indicator=this.panel?.querySelector(".system-color-scheme");if(indicator){this.colorScheme=this.detectColorScheme();indicator.textContent=`${this.colorScheme} mode`;indicator.dataset.scheme=this.colorScheme}}attachEventListeners(){this.panel.querySelectorAll("[data-action]").forEach(btn=>{btn.addEventListener("click",e=>{e.stopPropagation();const action=e.currentTarget.dataset.action;if(action==="close"){this.close()}else if(action==="toggle-debug"){document.body.classList.toggle("standard-debug");this.updateDebugIndicator();this.close()}else if(action==="reset"){this.resetAllTokens()}else if(action==="copy-all"){this.copyAllCSS()}})});this.attachInputListeners();this.panel.addEventListener("click",e=>{e.stopPropagation()});this.closeOnOutsideClick=e=>{if(this.isOpen&&this.panel&&!this.panel.contains(e.target)){this.close()}};setTimeout(()=>{document.addEventListener("click",this.closeOnOutsideClick,true)},100)}attachInputListeners(){this.panel.querySelectorAll(".system-input-text").forEach(input=>{input.addEventListener("input",e=>{const token=e.target.dataset.token;const value=e.target.value;const isFont=e.target.dataset.isFont==="true";document.documentElement.style.setProperty(token,value);if(isFont){this.loadGoogleFont(value)}})});this.panel.querySelectorAll(".system-input-color").forEach(input=>{input.addEventListener("input",e=>{const token=e.target.dataset.token;const color=e.target.value;document.documentElement.style.setProperty(token,color);const textInput=this.panel.querySelector(`.system-input-text[data-token="${token}"]`);if(textInput){textInput.value=color}})})}updateDebugIndicator(){const indicator=this.panel?.querySelector(".system-indicator");if(indicator){indicator.classList.toggle("active",document.body.classList.contains("standard-debug"))}}resetAllTokens(){if(!confirm("Reset all values to defaults?"))return;document.documentElement.removeAttribute("style");this.googleFontsLoaded.clear();this.close();setTimeout(()=>this.open(),100)}injectStyles(){if(document.getElementById("standard-system-styles"))return;const styles=document.createElement("style");styles.id="standard-system-styles";styles.textContent=`\n      .standard-system-panel {\n        position: fixed;\n        top: 0;\n        right: 0;\n        width: min(480px, 90vw);\n        height: 100vh;\n        background: var(--color-background);\n        border-left: 2px solid var(--color-accent);\n        box-shadow: -4px 0 24px rgba(0, 0, 0, 0.15);\n        z-index: 99999;\n        display: flex;\n        flex-direction: column;\n        font-family: var(--font-interface, system-ui);\n        font-size: var(--scale-s, 0.875rem);\n        opacity: 0;\n        transform: translateX(100%);\n        transition: opacity 0.2s ease, transform 0.2s ease;\n      }\n\n      .system-header {\n        padding: var(--space, 1rem);\n        border-bottom: 1px solid var(--color-border);\n        display: flex;\n        align-items: flex-start;\n        justify-content: space-between;\n        flex-shrink: 0;\n        gap: var(--space-s, 0.75rem);\n        flex-wrap: wrap;\n      }\n\n      .system-title-group {\n        display: flex;\n        flex-direction: column;\n        gap: var(--space-2xs, 0.25rem);\n      }\n\n      .system-header h2 {\n        margin: 0;\n        font-size: var(--scale, 1rem);\n        font-weight: 600;\n        letter-spacing: -0.02em;\n        line-height: 1.2;\n      }\n\n      .system-color-scheme {\n        font-size: var(--scale-s);\n        color: var(--color-muted);\n        text-transform: uppercase;\n        letter-spacing: 0.05em;\n        font-weight: 500;\n        display: inline-flex;\n        align-items: center;\n        gap: var(--space-2xs, 0.25rem);\n      }\n\n      .system-color-scheme::before {\n        content: '';\n        width: 8px;\n        height: 8px;\n        border-radius: 50%;\n        background: var(--color-subtle);\n      }\n\n      .system-color-scheme[data-scheme="dark"]::before {\n        background: var(--color-blue);\n        box-shadow: 0 0 8px var(--color-blue);\n      }\n\n      .system-color-scheme[data-scheme="light"]::before {\n        background: var(--color-yellow);\n        box-shadow: 0 0 8px var(--color-yellow);\n      }\n\n      .system-actions {\n        display: flex;\n        gap: var(--space-xs, 0.5rem);\n        flex-wrap: wrap;\n      }\n\n      .system-btn {\n        padding: var(--space-xs, 0.5rem) var(--space-s, 0.75rem);\n        background: var(--color-background-secondary);\n        border: 1px solid var(--color-border);\n        border-radius: var(--border-radius, 4px);\n        font-size: var(--scale-s);\n        cursor: pointer;\n        transition: all 0.15s ease;\n        font-family: inherit;\n        color: var(--color-foreground);\n        display: flex;\n        align-items: center;\n        gap: var(--space-2xs, 0.25rem);\n        white-space: nowrap;\n      }\n\n      .system-btn:hover {\n        background: var(--color-hover);\n        border-color: var(--color-accent);\n      }\n\n      .system-btn-primary {\n        background: var(--color-accent);\n        color: var(--color-background);\n        border-color: var(--color-accent);\n        font-weight: 600;\n      }\n\n      .system-btn-primary:hover {\n        opacity: 0.9;\n      }\n\n      .system-close {\n        font-size: 1.5rem;\n        line-height: 1;\n        padding: var(--space-xs, 0.5rem);\n        aspect-ratio: 1;\n      }\n\n      .system-indicator {\n        width: 8px;\n        height: 8px;\n        border-radius: 50%;\n        background: var(--color-subtle);\n        transition: background 0.2s ease;\n      }\n\n      .system-indicator.active {\n        background: var(--color-accent);\n        box-shadow: 0 0 8px var(--color-accent);\n      }\n\n      .system-content {\n        flex: 1;\n        overflow-y: auto;\n        padding: var(--space, 1rem);\n      }\n\n      .system-section {\n        margin-bottom: var(--space, 1rem);\n        border: 1px solid var(--color-border);\n        border-radius: var(--border-radius, 4px);\n        background: var(--color-background-secondary);\n      }\n\n      .system-section-title {\n        padding: var(--space-s, 0.75rem);\n        font-weight: 600;\n        cursor: pointer;\n        user-select: none;\n        text-transform: uppercase;\n        font-size: var(--scale-s);\n        letter-spacing: 0.05em;\n        border-bottom: 1px solid var(--color-border);\n        list-style: none;\n      }\n\n      .system-section-title::before {\n        content: '▸';\n        display: inline-block;\n        margin-right: var(--space-xs, 0.5rem);\n        transition: transform 0.2s ease;\n      }\n\n      .system-section[open] .system-section-title::before {\n        transform: rotate(90deg);\n      }\n\n      .system-section-content {\n        padding: var(--space-s, 0.75rem);\n      }\n\n      .system-row {\n        display: grid;\n        grid-template-columns: 140px 1fr;\n        gap: var(--space-s, 0.75rem);\n        align-items: center;\n        margin-bottom: var(--space-s, 0.75rem);\n        padding-bottom: var(--space-s, 0.75rem);\n        border-bottom: 1px solid color-mix(in srgb, var(--color-border) 50%, transparent);\n      }\n\n      .system-row:last-child {\n        margin-bottom: 0;\n        padding-bottom: 0;\n        border-bottom: none;\n      }\n\n      .system-label {\n        margin: 0;\n        font-size: var(--scale-s);\n        color: var(--color-muted);\n      }\n\n      .system-token {\n        font-family: var(--font-monospace, monospace);\n        font-size: var(--scale-s);\n        display: block;\n      }\n\n      .system-input-group {\n        display: flex;\n        gap: var(--space-2xs, 0.25rem);\n        align-items: center;\n        width: 100%;\n      }\n\n      .system-input-text {\n        padding: var(--space-xs, 0.5rem);\n        background: var(--color-background);\n        border: 1px solid var(--color-border);\n        border-radius: var(--border-radius, 4px);\n        font-size: var(--scale-s);\n        font-family: var(--font-monospace, monospace);\n        color: var(--color-foreground);\n        flex: 1;\n        min-width: 0;\n        transition: border-color 0.15s ease;\n      }\n\n      .system-input-text:focus {\n        outline: none;\n        border-color: var(--color-accent);\n        background: color-mix(in srgb, var(--color-accent) 5%, var(--color-background));\n      }\n\n      .system-input-font {\n        font-family: inherit;\n      }\n\n      .system-color-input {\n        display: flex;\n        gap: var(--space-2xs, 0.25rem);\n        align-items: center;\n        flex: 1;\n      }\n\n      .system-input-color {\n        width: 36px;\n        height: 32px;\n        border: 1px solid var(--color-border);\n        border-radius: var(--border-radius, 4px);\n        cursor: pointer;\n        padding: 2px;\n        background: var(--color-background);\n        flex-shrink: 0;\n      }\n\n      .system-input-color::-webkit-color-swatch-wrapper {\n        padding: 0;\n      }\n\n      .system-input-color::-webkit-color-swatch {\n        border: none;\n        border-radius: calc(var(--border-radius, 4px) - 2px);\n      }\n\n      .system-input-color::-moz-color-swatch {\n        border: none;\n        border-radius: calc(var(--border-radius, 4px) - 2px);\n      }\n\n      .system-footer {\n        padding: var(--space-s, 0.75rem) var(--space, 1rem);\n        border-top: 1px solid var(--color-border);\n        font-size: var(--scale-s);\n        color: var(--color-subtle);\n        text-align: center;\n        flex-shrink: 0;\n      }\n\n      .system-shortcut {\n        font-family: var(--font-monospace, monospace);\n      }\n\n      .system-notification {\n        position: fixed;\n        top: var(--space, 1rem);\n        left: 50%;\n        transform: translateX(-50%) translateY(-10px);\n        background: var(--color-background);\n        border: 1px solid var(--color-border);\n        border-radius: var(--border-radius, 4px);\n        padding: var(--space-s, 0.75rem) var(--space, 1rem);\n        box-shadow: var(--shadow, 0 2px 8px rgba(0,0,0,0.1));\n        z-index: 100000;\n        font-size: var(--scale-s);\n        opacity: 0;\n        transition: opacity 0.2s ease, transform 0.2s ease;\n        pointer-events: none;\n      }\n\n      .system-notification-success {\n        background: var(--color-success);\n        color: white;\n        border-color: var(--color-success);\n      }\n\n      /* Scrollbar styling */\n      .system-content::-webkit-scrollbar {\n        width: 8px;\n      }\n\n      .system-content::-webkit-scrollbar-track {\n        background: var(--color-background-secondary);\n      }\n\n      .system-content::-webkit-scrollbar-thumb {\n        background: var(--color-border);\n        border-radius: 4px;\n      }\n\n      .system-content::-webkit-scrollbar-thumb:hover {\n        background: var(--color-muted);\n      }\n\n      /* Dark mode optimizations */\n      @media (prefers-color-scheme: dark) {\n        .standard-system-panel {\n          box-shadow: -4px 0 32px rgba(0, 0, 0, 0.5);\n        }\n      }\n\n      /* Mobile responsive */\n      @media (max-width: 768px) {\n        .standard-system-panel {\n          width: 100vw;\n        }\n\n        .system-row {\n          grid-template-columns: 1fr;\n          gap: var(--space-2xs, 0.25rem);\n        }\n\n        .system-header {\n          flex-direction: column;\n          align-items: stretch;\n        }\n\n        .system-actions {\n          width: 100%;\n          justify-content: space-between;\n        }\n      }\n    `;document.head.appendChild(styles)}}if(typeof window!=="undefined"){if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",()=>{window.StandardLab=new StandardLab})}else{window.StandardLab=new StandardLab}}if(typeof module!=="undefined"&&module.exports){module.exports={StandardLab:StandardLab}}
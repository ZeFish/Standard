@use "standard-00-variables" as *;

/**
 * @component Color System
 * @category Colors
 * @description Advanced OKLCH-based color system with automatic harmony generation.
 * Set one "signal" color and the system mathematically generates a complete,
 * harmonious color palette with perfect consistency across light and dark modes.
 * 
 * The system uses OKLCH color space for perceptually uniform colors, preserving
 * the vibrancy and temperature of your chosen signal while rotating hues to
 * create semantic colors (success, warning, error, info, etc.).
 * 
 * ## Core Features
 * 
 * - **Single Input**: One signal color generates entire palette
 * - **Perceptual Uniformity**: OKLCH preserves lightness and chroma across spectrum
 * - **Smart Dark Mode**: Automatic brightness adjustment while preserving hue
 * - **Accessibility First**: WCAG AA compliant with built-in safety constraints
 * - **Temperature Preservation**: Warm colors stay warm, cool colors stay cool
 * - **Full Compatibility**: Works with manual overrides and legacy systems
 * 
 * ## Browser Support
 * 
 * OKLCH requires Chrome 111+, Safari 16.4+, Firefox 113+ (March-May 2023)
 * Older browsers gracefully fall back to default color values.
 * 
 * @prop {color} --signal Primary brand/accent color (the seed for all others)
 * @prop {color} --color-background Page background color
 * @prop {color} --color-foreground Text foreground color
 * @prop {color} --color-accent Primary accent color (derived from signal)
 * @prop {color} --pigment-red Generated red (errors, deletions) - 25° hue
 * @prop {color} --pigment-yellow Generated yellow (warnings, highlights) - 85° hue
 * @prop {color} --pigment-green Generated green (success, insertions) - 145° hue
 * @prop {color} --pigment-cyan Generated cyan (info, metadata) - 190° hue
 * @prop {color} --pigment-blue Generated blue (links, focus) - 240° hue
 * @prop {color} --pigment-purple Generated purple (magic, AI) - 300° hue
 *
 * @example scss - Simple: Just set one color
 * :root {
 *   --signal: #d65d0e;
 * }
 *
 * @example scss - Advanced: Override specific pigments
 * :root {
 *   --signal: #7a5a2e;
 *   --pigment-red: #a84032;
 * }
 * 
 * @example scss - Legacy: Set colors manually
 * :root {
 *   --color-success: #5e9d80;
 *   --color-error: #b14c42;
 * }
 *
 * @since 0.18.0
 * @see https://developer.chrome.com/blog/css-relative-color-syntax/
 * @see https://webaim.org/articles/contrast/
 * @see https://oklch.com/
 */

/* ============================================
   STANDARD COLOR SYSTEM
   OKLCH-Based Automatic Harmony Generation
   ============================================ */

:root {
  /* Browser color scheme support */
  color-scheme: light dark;

  /* ================================================================
     SECTION 1: THE SIGNAL COLOR (User Input)
     ================================================================
     
     This is the ONLY color users need to define.
     All other colors generate automatically from this seed.
     
     Set to any valid CSS color: hex, rgb, hsl, oklch, etc.
     ================================================================ */
  
  --signal: #d65d0e; /* Default: Safety Orange */

  /* ================================================================
     SECTION 2: DNA EXTRACTION (OKLCH Analysis)
     ================================================================
     
     Extract the three components of the signal color:
     - Lightness (l): How bright/dark (0-1)
     - Chroma (c): How vibrant/saturated (0-0.4)
     - Hue (h): The color angle (0-360°)
     
     These form the "DNA" that all generated colors inherit.
     ================================================================ */
  
  --dna-l: oklch(from var(--signal) l);
  --dna-c: oklch(from var(--signal) c);
  --dna-h: oklch(from var(--signal) h);

  /* ================================================================
     SECTION 3: SAFETY CONSTRAINTS (Accessibility)
     ================================================================
     
     Apply minimum/maximum bounds to ensure:
     - Colors aren't too gray (minimum chroma)
     - Text is readable (clamped lightness)
     - WCAG AA contrast compliance
     ================================================================ */
  
  /* Minimum vibrancy - prevents gray colors from black/white signals */
  --safe-c: max(var(--dna-c), 0.12);
  
  /* Readable lightness range - prevents too light/dark text */
  --safe-l: clamp(0.35, var(--dna-l), 0.75);

  /* ================================================================
     SECTION 4: THE GENERATED SPECTRUM (Hue Rotation)
     ================================================================
     
     Generate six semantic colors by rotating the hue while
     preserving lightness and chroma from the signal's DNA.
     
     Each color sits at a specific hue angle for optimal harmony:
     - Red (25°): Warm, urgent
     - Yellow (85°): Bright, attention
     - Green (145°): Natural, positive
     - Cyan (190°): Cool, informative
     - Blue (240°): Trustworthy, primary
     - Purple (300°): Creative, special
     
     All inherit the signal's vibrancy and brightness character.
     ================================================================ */
  
  --pigment-red: oklch(var(--safe-l) var(--safe-c) 25);
  --pigment-yellow: oklch(var(--safe-l) var(--safe-c) 85);
  --pigment-green: oklch(var(--safe-l) var(--safe-c) 145);
  --pigment-cyan: oklch(var(--safe-l) var(--safe-c) 190);
  --pigment-blue: oklch(var(--safe-l) var(--safe-c) 240);
  --pigment-purple: oklch(var(--safe-l) var(--safe-c) 300);

  /* ================================================================
     SECTION 5: LIGHT MODE FOUNDATION
     ================================================================
     
     Default background and foreground colors for light mode.
     These can be overridden by themes or user preferences.
     ================================================================ */
  
  --color-light-background: #ffffff;
  --color-light-foreground: #262626;
  --color-light-accent: var(--signal);

  /* ================================================================
     SECTION 6: DARK MODE FOUNDATION
     ================================================================
     
     Dark mode colors with intelligent adjustments:
     - Background: Deep dark (not pure black for reduced eye strain)
     - Foreground: Soft white (not pure white for better contrast)
     - Accent: Brightened signal for visibility on dark backgrounds
     ================================================================ */
  
  --color-dark-background: #0f0f0f;
  --color-dark-foreground: #dbdbdb;
  --color-dark-accent: oklch(from var(--signal) calc(l + 0.12) c h);

  /* ================================================================
     SECTION 7: ACTIVE COLOR TOKENS (Light Mode Default)
     ================================================================
     
     These are the colors actively used throughout the framework.
     They default to light mode and switch in the dark mode media query.
     ================================================================ */
  
  /* Core UI colors */
  --color-background: var(--color-light-background);
  --color-foreground: var(--color-light-foreground);
  --color-accent: var(--color-light-accent);
  --color-header: var(--color-foreground);

  /* Semantic hue colors mapped to generated pigments */
  --color-red: var(--pigment-red);
  --color-orange: oklch(var(--safe-l) var(--safe-c) 55);
  --color-yellow: var(--pigment-yellow);
  --color-green: var(--pigment-green);
  --color-cyan: var(--pigment-cyan);
  --color-blue: var(--pigment-blue);
  --color-magenta: var(--pigment-purple);

  /* Semantic state colors */
  --color-success: var(--pigment-green);
  --color-warning: var(--pigment-yellow);
  --color-error: var(--pigment-red);
  --color-info: var(--pigment-blue);

  /* Interactive colors */
  --color-link: var(--pigment-blue);
  --color-on-accent: var(--color-background);

  /* Light/Dark references for relative color mixing */
  --color-light: var(--color-light-background);
  --color-dark: var(--color-light-foreground);

  /* ================================================================
     SECTION 8: COMPUTED TRANSPARENCY LAYERS
     ================================================================
     
     Semi-transparent variations using color-mix for subtle UI elements.
     These adjust automatically based on foreground/background colors.
     ================================================================ */
  
  /* Text opacity variations */
  --color-muted: color-mix(in srgb, var(--color-foreground) 60%, transparent);
  --color-subtle: color-mix(in srgb, var(--color-foreground) 40%, transparent);
  
  /* Surface and border layers */
  --color-border: color-mix(in srgb, var(--color-foreground) 10%, transparent);
  --color-surface: color-mix(in srgb, var(--color-foreground) 3%, transparent);
  --color-secondary: color-mix(
    in srgb,
    var(--color-foreground) 3%,
    var(--color-background)
  );

  /* Accent-based surfaces */
  --color-background-accent: color-mix(
    in srgb,
    var(--color-accent) 7%,
    transparent
  );
  
  /* Interactive state overlays */
  --color-hover: color-mix(in srgb, var(--color-accent) 35%, transparent);
  --color-active: color-mix(in srgb, var(--color-accent) 20%, transparent);
  --color-pop: color-mix(in srgb, var(--color-foreground) 22%, transparent);
  
  /* Light/dark shading helpers */
  --color-lighter: color-mix(in srgb, var(--color-light) 15%, transparent);
  --color-darker: color-mix(in srgb, var(--color-dark) 15%, transparent);
  
  /* Modal and overlay backgrounds */
  --color-modal-background: color-mix(
    in srgb,
    color-mix(in srgb, var(--color-foreground) 10%, var(--color-background)) 60%,
    transparent
  );

  /* ================================================================
     SECTION 9: TINT SCALE (10-Step Gradient)
     ================================================================
     
     A numeric scale from 1-10 for fine-grained color control:
     - 1-5: Foreground mixed into background (subtle lightening)
     - 6-10: Background mixed into foreground (subtle darkening)
     
     Useful for creating layered surfaces and depth hierarchies.
     ================================================================ */
  
  --color-1: color-mix(in srgb, var(--color-foreground) 3%, var(--color-background));
  --color-2: color-mix(in srgb, var(--color-foreground) 5%, var(--color-background));
  --color-3: color-mix(in srgb, var(--color-foreground) 7%, var(--color-background));
  --color-4: color-mix(in srgb, var(--color-foreground) 10%, var(--color-background));
  --color-5: color-mix(in srgb, var(--color-foreground) 20%, var(--color-background));
  --color-6: color-mix(in srgb, var(--color-background) 3%, var(--color-foreground));
  --color-7: color-mix(in srgb, var(--color-background) 5%, var(--color-foreground));
  --color-8: color-mix(in srgb, var(--color-background) 7%, var(--color-foreground));
  --color-9: color-mix(in srgb, var(--color-background) 10%, var(--color-foreground));
  --color-10: color-mix(in srgb, var(--color-background) 20%, var(--color-foreground));

  /* ================================================================
     SECTION 10: SHADOWS AND VISUAL EFFECTS
     ================================================================
     
     Depth and elevation effects using computed shadow colors.
     ================================================================ */
  
  --color-shadow: color-mix(in srgb, var(--color-dark) 5%, transparent);
  --shadow: 0 1px 2px var(--color-shadow);
  --shadow-l: 0 4px 6px -1px var(--color-darker), 0 2px 4px -2px var(--color-darker);

  /* ================================================================
     SECTION 11: DESIGN TOKENS (Borders & Transitions)
     ================================================================ */
  
  --border: var(--stroke-width) solid var(--color-border);
  --border-accent: var(--stroke-width) solid color-mix(in srgb, var(--color-accent) 7%, transparent);

  /* Smooth theme transition animation */
  transition:
    background-color var(--transition),
    color var(--transition),
    border-color var(--transition);
}

/* ====================================================================
   DARK MODE: Automatic Color Inversion
   ====================================================================
   
   When the system or browser requests dark mode, intelligently
   adjust colors while preserving their essential character:
   
   - Flip background/foreground lightness
   - Brighten pigments for visibility on dark backgrounds
   - Maintain hue and chroma (temperature and vibrancy)
   - Adjust transparency layers for better contrast
   
   This creates a true dark theme, not just inverted colors.
   ==================================================================== */
@media (prefers-color-scheme: dark) {
  :root {
    /* Core UI colors - flip to dark mode variants */
    --color-background: var(--color-dark-background);
    --color-foreground: var(--color-dark-foreground);
    --color-accent: var(--color-dark-accent);
    --color-header: var(--color-foreground);
    
    /* Light/dark reference swap */
    --color-light: var(--color-dark-foreground);
    --color-dark: var(--color-dark-background);

    /* Brighten all pigments by +0.15 lightness for visibility */
    --pigment-red: oklch(calc(var(--safe-l) + 0.15) var(--safe-c) 25);
    --pigment-yellow: oklch(calc(var(--safe-l) + 0.15) var(--safe-c) 85);
    --pigment-green: oklch(calc(var(--safe-l) + 0.15) var(--safe-c) 145);
    --pigment-cyan: oklch(calc(var(--safe-l) + 0.15) var(--safe-c) 190);
    --pigment-blue: oklch(calc(var(--safe-l) + 0.15) var(--safe-c) 240);
    --pigment-purple: oklch(calc(var(--safe-l) + 0.15) var(--safe-c) 300);

    /* Update semantic colors to use brightened pigments */
    --color-red: var(--pigment-red);
    --color-orange: oklch(calc(var(--safe-l) + 0.15) var(--safe-c) 55);
    --color-yellow: var(--pigment-yellow);
    --color-green: var(--pigment-green);
    --color-cyan: var(--pigment-cyan);
    --color-blue: var(--pigment-blue);
    --color-magenta: var(--pigment-purple);
    --color-link: var(--pigment-blue);

    /* Adjusted transparency layers for better dark mode contrast */
    --color-muted: color-mix(in srgb, var(--color-foreground) 65%, transparent);
    --color-subtle: color-mix(in srgb, var(--color-foreground) 45%, transparent);
    --color-border: color-mix(in srgb, var(--color-foreground) 7%, var(--color-background));
    --color-surface: color-mix(in srgb, black 10%, transparent);
    --color-secondary: color-mix(in srgb, black 3%, var(--color-background));
    --color-modal-background: color-mix(
      in srgb,
      color-mix(in srgb, black 75%, var(--color-background)) 60%,
      transparent
    );
  }
}

/* ====================================================================
   ACCESSIBILITY: Motion Preferences
   ====================================================================
   
   Respect user's reduced motion preference by disabling all transitions
   and animations. Essential for users with vestibular disorders.
   ==================================================================== */

@media (prefers-reduced-motion: reduce) {
  :root {
    transition: none;
  }

  * {
    transition: none !important;
    animation: none !important;
  }
}

/* ====================================================================
   ACCESSIBILITY: High Contrast Mode
   ====================================================================
   
   Windows High Contrast mode uses system color keywords.
   These override all custom colors for maximum readability.
   ==================================================================== */

@media (forced-colors: active) {
  :root {
    --color-background: Canvas;
    --color-foreground: CanvasText;
    --color-accent: Highlight;
    --color-border: CanvasText;
    --color-muted: GrayText;
  }
}

/* ====================================================================
   BASE HTML ELEMENT STYLING
   ====================================================================
   
   Apply color system to root HTML element with smooth transitions.
   ==================================================================== */

html {
  color: var(--color-foreground);
  background: var(--color-background);

  /* Smooth color transitions when switching themes */
  transition:
    background-color var(--transition),
    color var(--transition);
}

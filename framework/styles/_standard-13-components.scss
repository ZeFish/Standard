@use "standard-00-variables" as *;

/* =========================== */
/* BUTTONS                     */
/* =========================== */

.loader {
  width: var(--space-2);
  height: var(--space-2);
  border: var(--trim) solid transparent;
  border-bottom-color: #{alpha(--color-accent, 85)};
  background: transparent;
  border-radius: 50%;
  display: inline-block;
  box-sizing: border-box;
  filter: blur(0.3px);
  animation: rotation 0.25s linear infinite;

  --color-loading-mix: color-mix(in srgb, var(--color-accent) 100%, black);
  --color-loading: #{alpha(--color-loading-mix, 25)};
  border-bottom-color: color-mix(
    in srgb,
    var(--color-loading) 100%,
    transparent
  );
  box-shadow:
    0px 4px 6px -2px var(--color-loading),
    inset 0px -4px 6px -2px var(--color-loading);
}

@keyframes rotation {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

kbd {
  background: var(--color-surface);
  border: var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: var(--leading);
  font-family: var(--font-monospace);
  font-size: var(--scale-d3);
  color: var(--color-foreground);
}

$types: "secondary", "outline", "destructive", "ghost", "icon";

button,
a.btn {
  @extend %surface;
  @extend %padding-text;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-interface);
  font-weight: var(--font-weight-bold);
  line-height: var(--line-height);
  background: var(--color-accent);
  color: var(--color-on-accent);
  cursor: pointer;
  gap: var(--trim);
  transition: all var(--transition);

  text-box-trim: trim-both;
  text-box-edge: cap alphabetic;

  &:hover {
    color: var(--color-on-accent);
    background: #{mix(--color-accent, 70, --color-surface)};
  }
  /* Loop through the list to create .badge-outline, .badge-ghost, etc. */
  @each $type in $types {
    &.#{$type} {
      @extend .btn;
      @extend button;
    }
  }
}

button.small,
a.btn.small {
  padding: var(--space-d6) var(--space-d4);
}
a.btn:visited,
a.btn {
  --stroke-width: 1px;
  display: inline-block;
  width: fit-content;
  user-select: none;
  margin-inline: auto;
  text-decoration: none;
  text-align: center;
  box-sizing: border-box;
}

button:active,
a.btn:active {
  background: #{mix(--color-accent, 50, --color-surface)};
}

button:focus-visible,
a.btn:focus-visible {
  outline: 1px solid #{alpha(--color-accent, 0)};
  outline-offset: 2px;
  color: var(--color-background);
}

button.destructive,
a.btn-destructive {
  background-color: var(--color-surface);
  border-color: #{mix(--color-error, 10, --color-border)};
  color: var(--color-error);
  &:hover {
    background: var(--color-error);
    color: var(--color-on-accent);
  }
}

button:disabled,
a.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

button.secondary,
a.btn.secondary {
  background: var(--color-surface);
  color: var(--color-foreground);
  &:hover {
    background: #{mix(currentColor, 5, --color-surface)};
  }
}

button.link,
a.btn.link {
  background: var(--color-surface);
  color: var(--color-link);
  &:hover {
    background: color-mix(in srgb, currentColor 10%, var(--color-surface));
  }
}

button.outline,
a.btn.outline {
  background: transparent;
  color: var(--color-subtle);
  &:hover {
    color: var(--color-foreground);
    background-color: var(--color-surface);
  }
}
button.outline:hover,
a.btn.outline:hover {
  background: color-mix(in srgb, currentColor 5%, var(--color-surface));
}
button.icon,
a.btn.icon {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  margin: 0;
  width: calc(var(--space) + var(--trim));
  height: calc(var(--space) + var(--trim));
}
button.ghost,
a.btn.ghost {
  background: none;
  border: none;
  box-shadow: none;
  color: var(--color-muted);
  &:hover {
    color: var(--color-foreground);
    background: color-mix(in srgb, currentColor 5%, var(--color-surface));
  }
}

/*
:is(button, .btn) svg {
  height: 100%;
  width: auto;
  fill: currentColor;
}
*/

.tag {
  color: var(--color-muted);
}

.tag:hover {
  color: var(--color-accent);
}

.badge {
  @extend %padding-text;
  padding: var(--space-d8) var(--space-d3);
  background-color: var(--color-accent);
  color: var(--color-on-accent);
  border-radius: var(--space-half);
  border: var(--border);
  font-size: var(--scale-d3);
  display: inline-flex;
  align-items: center;
  gap: calc(var(--leading) + var(--trim));
  text-box-trim: trim-both;
  text-box-edge: cap alphabetic;
  text-decoration: none;
  font-weight: 600;
  font-family: var(--font-interface);
  user-select: none;

  transition: all var(--transition);

  font-variation-settings: "wdth" 900;

  svg {
    max-height: var(--scale-d3);
    margin-inline: calc(var(--trim) * -2);
  }

  ::selection {
    background: transparent;
    color: currentColor;
  }

  /* Loop through the list to create .badge-outline, .badge-ghost, etc. */
  @each $type in $types {
    &.#{$type} {
      @extend .badge;
    }
  }
}

a.badge:hover {
  color: var(--color-on-accent);
  background: color-mix(in srgb, var(--color-accent) 70%, var(--color-surface));
}
.badge.secondary,
a.badge.secondary {
  background-color: var(--color-surface);
  color: var(--color-foreground);
  svg {
    max-height: var(--scale-d3);
    margin-inline: calc(var(--trim) * -2);
  }
}
a.badge.secondary:hover {
  color: var(--color-foreground);
  background: color-mix(in srgb, currentColor 5%, var(--color-surface));
}
.badge.outline {
  background-color: transparent;
  color: var(--color-muted);
  svg {
    max-height: var(--scale-d3);
    margin-inline: calc(var(--trim) * -2);
  }
  &:hover {
    color: var(--color-foreground);
    background: var(--color-surface);
  }
}

.badge.ghost {
  background-color: transparent;
  border-color: transparent;
  color: var(--color-muted);
  svg {
    max-height: var(--scale-d3);
    margin-inline: calc(var(--trim) * -2);
  }
  &:hover {
    color: var(--color-foreground);
    background: var(--color-surface);
  }
}

.badge.destructive {
  background-color: var(--color-surface);
  border-color: color-mix(in srgb, var(--color-error) 10%, var(--color-border));
  color: var(--color-error);
  svg {
    max-height: var(--scale-d3);
    margin-inline: calc(var(--trim) * -2);
  }
  &:hover {
    background-color: var(--color-error);
    color: var(--color-on-accent);
  }
}

.breadcrumbs {
  font-family: var(--font-interface);
  color: var(--color-muted);
  list-style: none;
  padding-inline-start: 0;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  font-size: var(--scale-d3);
  * {
    margin-block: 0;
  }
  a {
    text-decoration: none;
    cursor: pointer;
  }
  li::before {
    display: none;
  }
}
/* =========================== */
/* NAVIGATION                  */
/* =========================== */

nav li a {
  text-decoration: none;
}

nav li.is-active a {
  text-decoration: underline;
}

/* Vertical menu navigation */
nav.menu ul,
ul.menu {
  display: flex;
  flex-direction: column;
  padding-inline: 0;
  gap: 0;

  li {
    list-style: none;
    padding-inline-start: 0;
    margin-block-end: var(--space-half);

    &::before {
      display: none;
    }
  }
}

.tight nav.menu ul li {
  margin-block-end: var(--trim);
}

/* Horizontal menu navigation */
nav.menu.horizontal ul,
ul.menu.horizontal {
  flex-direction: row;
  gap: var(--space-half);

  li {
    padding-inline-start: 0;
    margin-block: 0;
  }
}

/**
 * @name Card Component
 * @group components-layout
 * @author Francis Fontaine
 * @since 0.11.0
 *
 * In 1991, Edward Tufte published "Envisioning Information" and introduced
 * the concept of "small multiples"—the idea that human brains excel at
 * comparing information when it's presented in identical visual containers.
 * Show someone seven weather forecasts in seven different layouts, and they'll
 * struggle. Show them seven identical cards with different data, and patterns
 * emerge instantly. The structure disappears, the content shines.
 *
 * But here's the catch: small multiples only work when they're truly identical.
 * One card with 16px padding, another with 20px, a third with 18px—your brain
 * registers the inconsistency before it processes the content. This component
 * solves that problem by providing a single source of truth for card structure.
 * Every card gets the same padding, the same borders, the same rhythm. Build
 * one card or build a hundred—they'll feel like family.
 *
 * The Swiss designers understood this in the 1950s. Josef Müller-Brockmann's
 * concert posters used rigid grids not to constrain creativity, but to amplify
 * it. When the structure is invisible, when it just works, your content can
 * breathe. That's what `.card` does—it handles the boring consistency so you
 * can focus on making something beautiful.
 *
 * ### Future Improvements
 *
 * - Elevation variants (flat, raised, floating) with shadow scales
 * - Interactive hover states for clickable cards with smooth transitions
 * - Horizontal card layout variant for image + content side-by-side
 * - Dark mode shadow adjustments for better depth perception
 * - Optional card image hero with object-fit controls
 *
 * @see {class} .grid - Often used to layout multiple cards in columns
 * @see {variable} --base - Controls internal spacing rhythm
 * @see {class} .prose - Can be used inside card-body for rich content
 *
 * @link https://en.wikipedia.org/wiki/Edward_Tufte Information Design Pioneer
 * @link https://www.nngroup.com/articles/cards-component/ NN/g Cards Research
 *
 * @example html - Basic card structure
 *   <article class="card">
 *     <header class="card-header">
 *       <h3>Card Title</h3>
 *     </header>
 *     <div class="card-body">
 *       <p>Card content with automatic spacing and rhythm.</p>
 *     </div>
 *     <footer class="card-footer">
 *       <a href="#">Read more →</a>
 *     </footer>
 *   </article>
 *
 * @example html - Cards in grid layout (3-column responsive)
 *   <div class="grid">
 *     <article class="card col-4 col-sm-12">
 *       <div class="card-body">
 *         <h3>Feature One</h3>
 *         <p>Description...</p>
 *       </div>
 *     </article>
 *     <article class="card col-4 col-sm-12">...</article>
 *     <article class="card col-4 col-sm-12">...</article>
 *   </div>
 *
 * @example html - Clickable card (entire card is a link)
 *   <a href="/article" class="card card-clickable">
 *     <div class="card-body">
 *       <h3>Article Title</h3>
 *       <p>Preview text that entices you to click...</p>
 *     </div>
 *   </a>
 *
 * @example scss - Customizing card via CSS variables
 *   .card.custom {
 *     --card-border-color: var(--color-accent);
 *     --card-padding: var(--space-2);
 *     --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
 *   }
 */

/**
 * @name Clickable Card Variant
 * @group components-layout
 * @since 0.11.0
 *
 * Sometimes your entire card should be clickable—a blog post preview, a product
 * listing, a project showcase. This variant ensures proper hover states, focus
 * indicators, and cursor feedback while maintaining the card's structural integrity.
 *
 * The subtle lift on hover (2px translateY) and enhanced shadow create the
 * illusion of depth—like the card is rising toward you. It's a tactile metaphor
 * for "this is interactive." The focus-visible outline ensures keyboard users
 * can see exactly where they are.
 *
 * Accessibility note: When using clickable cards, ensure the link text is
 * descriptive. "Read more" alone isn't enough—screen readers need context.
 * Use "Read more about [article title]" or aria-label.
 *
 * @see {class} .card - Base component
 * @see {element} a - Applied to anchor tag wrapping card content
 *
 * @example html - Accessible clickable card
 *   <a href="/article/typography-history" class="card card-clickable"
 *      aria-label="Read full article about Typography History">
 *     <div class="card-body">
 *       <h3>Typography History</h3>
 *       <p>The evolution of type from Gutenberg to now...</p>
 *     </div>
 *     <div class="card-footer">
 *       Read more →
 *     </div>
 *   </a>
 */
.card {
  @extend %surface;
  padding: var(--space);
  box-shadow: var(--shadow);

  svg {
    max-height: var(--scale);
  }

  padding: var(--space);
  overflow: hidden;

  img {
    border-radius: 0px;
    border: 0;
    box-shadow: 0;
  }
}
.card > * + * {
  padding-block-start: var(--space);
}
.card > header:first-child {
  padding: var(--space);
  margin: calc(var(--space) * -1);

  &.surface {
    margin-bottom: 0;
    border-bottom: var(--border);
    box-shadow: var(--shadow);
    background-color: var(--color-surface);
  }

  p {
    margin-top: var(--space-half);
    color: var(--color-muted);
    font-size: var(--scale-d2);
  }
}
.card.icon > header:first-child {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.card > footer:last-child {
  margin-top: var(--space-half);
}

.card.clickable {
  a {
    text-decoration: none;
  }

  color: inherit;
  transition:
    transform var(--transition),
    box-shadow var(--transition);
  cursor: pointer;

  &:hover {
    transform: translateY(-2px);
    /* Subtle lift */
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    /* Enhanced shadow */
  }

  &:focus-visible {
    outline: 3px solid var(--color-accent);
    outline-offset: 2px;
  }

  &:active {
    transform: translateY(0);
    /* Press down on click */
  }
}

pre,
.inset,
card.inset {
  box-shadow: inset var(--shadow) !important;
}

.callout {
  box-shadow: var(--shadow);
  background: var(--color-surface);
  border: var(--border);
  border-radius: var(--radius);
  transition: var(--duration-superfast) ease;
  padding: var(--trim);
  padding-top: 0;
  --color-callout: var(--color-surface);
  --color-border: color-mix(in srgb, var(--color-callout) 15%, transparent);
  background: color-mix(in srgb, var(--color-callout) 5%, var(--color-surface));
  font-size: var(--scale-d2);

  .callout-title,
  > summary {
    position: relative;
    color: color-mix(
      in srgb,
      var(--color-callout) 50%,
      var(--color-foreground)
    );
    display: flex;
    font-weight: var(--font-weight-bold, bold);

    user-select: none;
    padding: var(--space-half);
    margin: 0 !important;
    .callout-title-inner {
      margin: 0;
    }
  }

  .callout-content {
    color: var(--color-foreground);
    background: color-mix(
      in srgb,
      var(--color-callout) 0.5%,
      color-mix(in srgb, var(--color-surface) 25%, var(--color-background))
    );
    line-height: var(--line-height-compact);
    box-shadow: inset var(--shadow);
    border-radius: var(--radius);
    padding: var(--space-half);
    margin-top: 0;
    margin-left: 0;
    border: var(--border);
    text-align: left;

    p:first-child {
      margin-top: 0;
    }

    p:last-child {
      margin-bottom: 0;
    }

    ul,
    ol {
      padding: 0 calc(var(--leading));
      list-style: none;
    }

    pre {
      margin: var(--leading) 0;
    }

    > .callout {
      margin: calc(var(--space) * -1);

      .callout-content {
        padding: var(--space);
      }

      .callout-title {
        padding-left: var(--space);
        padding-right: var(--space);
      }
    }
  }

  .callout-title-icon {
    display: none;
  }

  img {
    margin-left: 0;
    margin-right: 0;
  }
}

// Callout Color Variants
.callout[data-callout="warning" i] {
  --color-callout: var(--color-red);
}

.callout[data-callout="important" i] {
  --color-callout: var(--color-orange);
}

// Details/Summary specific callout styles
details > summary {
  list-style: none;
  /* removes marker in Firefox */
}

details .callout-title::before {
  content: "▸";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform var(--transition);
  margin-right: var(--leading);
  text-align: center;
  text-box-trim: trim-both;
  text-box-edge: cap alphabetic;
  transform-origin: center;
}

details[open] .callout-title::before {
  transform: rotate(90deg);
}

details .callout-title-inner {
  display: inline;
}

// Caption Callout (after an image)
p:has(img) + .callout[data-callout="caption" i] {
  padding: 0;
  background: none;
  border: none;
  margin: 0 var(--space);
  position: relative;
  top: calc(var(--leading) * -1);
  box-shadow: none;

  .callout-title {
    display: none;
  }

  .callout-content {
    padding: 0;
    background: none;
    border: none;

    box-shadow: none;
    text-align: center !important;
    text-wrap: balance !important;
  }
}

.mermaid {
  background: var(--color-surface);
  border-radius: var(--radius);
  border: var(--border);
  position: relative;
  text-align: center;
  margin: 0 auto var(--space) auto;
  padding: var(--space);
}

.alert {
  font-family: var(--font-interface);
  --color-alert: var(--color-accent);
  padding: var(--space-half);
  color: color-mix(
    in srgb,
    var(--color-alert) 10%,
    var(--color-foreground)
  ) !important;
  background: color-mix(in srgb, var(--color-alert) 10%, var(--color-surface));
  border-left: var(--stroke-width) solid
    color-mix(in srgb, var(--color-alert) 50%, var(--color-border));
}

// Callout Color Variants
.alert.warning {
  --color-alert: var(--color-warning);
}

.alert.error {
  --color-alert: var(--color-error);
}

.alert.success {
  --color-alert: var(--color-success);
}

/**
 * @name Comments
 * @group comments
 * @since 0.11.0
 */

#comments {
  * {
    margin-block-end: 0;
  }

  font-size: var(--scale-d2);

  .comment {
    border: var(--border);
    box-shadow: var(--shadow);
    border-radius: var(--radius);
    background: var(--color-surface);
    padding: calc(var(--space-half) + var(--leading)) var(--space-half);
    margin-block-end: var(--space);

    .comment-header {
      display: flex;
      align-items: baseline;
      gap: var(--leading);

      .comment-author {
        font-weight: var(--font-weight-bold);
      }

      .comment-date,
      .comment-pending {
        color: var(--color-subtle);
        font-size: var(--scale-d3);
      }

      .comment-pending {
        font-style: italic;
        color: var(--color-orange);
      }
    }

    .comment-content {
      margin-inline: var(--space-half);
      margin-block-start: var(--leading);
      border-left: var(--border);
      padding: var(--space-half);
      color: var(--color-muted);
      font-size: var(--scale-d2);
      line-height: var(--line-height-compact);
    }
  }

  :last-child {
    margin-block-end: 0;
  }
}

/**
 * @name Alert Action Links
 * @group components-feedback
 * @since 0.11.0
 *
 * Actions within alerts (links, buttons) should be visually distinct but not
 * overwhelming. This provides subtle styling that inherits the alert's color.
 */
.alert-action {
  display: inline-block;
  margin-inline-start: var(--space-d2);
  color: var(--alert-border-color);
  text-decoration: underline;
  font-weight: var(--font-weight-bold);

  &:hover {
    text-decoration-thickness: 0.15em;
  }
}

a.skip-link {
  /* Positioning - absolute to top-left corner */
  position: absolute;
  top: var(--space-d4);
  left: var(--space-d4);
  z-index: var(--z-modal);
  /* Above everything else */

  /* Styling - high contrast, unmissable */
  background: var(--color-accent);
  color: var(--color-background);
  padding: var(--space-d4) var(--space-d4);
  border-radius: var(--radius);
  font-weight: var(--font-weight-bold);
  font-size: var(--scale-d2);
  text-decoration: none;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);

  /* Animation */
  transition:
    transform var(--transition),
    opacity var(--transition);

  /* Hidden by default (accessible hiding) */
  transform: translateY(-120%);
  opacity: 0;

  /* Visible on focus (Tab key) */
  &:focus {
    transform: translateY(0);
    opacity: 1;
    outline: 3px solid var(--color-background);
    outline-offset: 2px;
  }

  /* Hover state (if user moves mouse while focused) */
  &:hover {
    background: color-mix(
      in srgb,
      var(--color-accent) 90%,
      var(--color-background)
    );
    color: var(--color-background);
  }

  /* Active state (on click) */
  &:active {
    transform: translateY(0) scale(0.98);
  }
}

.skip-links {
  position: absolute;
  top: 0;
  left: 0;
  z-index: var(--z-modal);
  display: flex;
  flex-direction: column;
  gap: var(--space);
  padding: var(--trim);
}

.scroll {
  /* Container styling */
  position: relative;
  width: 100%;
  overflow-x: auto;
  overflow-y: auto;

  /* Smooth scrolling with momentum */

  &::before,
  &::after {
    content: "";
    position: absolute;
    top: 0;
    bottom: 0;
    z-index: 2;
    pointer-events: none;
    transition: opacity 0.05s linear;
    width: var(--space);
    opacity: 0;
  }

  &::before {
    left: 0;
    background: linear-gradient(
      to right,
      var(--color-background) 25%,
      transparent 100%
    );
  }

  /* Define the Right Shadow (initially visible) */
  &::after {
    right: 0;
    background: linear-gradient(
      to left,
      var(--color-background) 25%,
      transparent 100%
    );
  }

  /* When this class is added, the left shadow fades in. */
  &.show-left-shadow::before {
    opacity: 0;
  }

  /* When this class is added, the right shadow fades out. */
  &.show-right-shadow::after {
    opacity: 0;
  }

  & > * {
    margin-block-end: 0;
    /* Remove table's own margin */
    min-width: 100%;
    /* Ensure table fills wrapper */
    width: max-content;
    /* Allow table to grow beyond wrapper */
  }
}

.field {
  /* Field container */
  display: flex;
  flex-direction: column;
  gap: var(--space);

  /* Label styling */
  label {
    font-weight: var(--font-weight-bold);
    font-size: var(--scale-d2);
    color: var(--color-foreground);
  }
}

[data-tooltip] {
  position: relative;
  cursor: help;
}

/* The tooltip bubble */
[data-tooltip]::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(10px) scale(0.95);

  background: var(--tooltip-bg);
  color: var(--tooltip-text);
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  white-space: nowrap;
  pointer-events: none;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);

  /* Hidden state */
  opacity: 0;
  visibility: hidden;
  transition: all 0.2s var(--tooltip-ease);
}

/* The arrow */
[data-tooltip]::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(10px);
  border: 5px solid transparent;
  border-top-color: var(--tooltip-bg);
  margin-bottom: -10px;
  opacity: 0;
  visibility: hidden;
  transition: all 0.2s var(--tooltip-ease);
  pointer-events: none;
  z-index: 1000;
}

/* Hover state */
[data-tooltip]:hover::after,
[data-tooltip]:hover::before {
  opacity: 1;
  visibility: visible;
  transform: translateX(-50%) translateY(-8px) scale(1);
}

/* Bottom position variant */
[data-tooltip-pos="bottom"]::after {
  bottom: auto;
  top: 100%;
  transform: translateX(-50%) translateY(-10px) scale(0.95);
}

[data-tooltip-pos="bottom"]::before {
  bottom: auto;
  top: 100%;
  border-top-color: transparent;
  border-bottom-color: var(--tooltip-bg);
  margin-bottom: 0;
  margin-top: -10px;
}

[data-tooltip-pos="bottom"]:hover::after,
[data-tooltip-pos="bottom"]:hover::before {
  transform: translateX(-50%) translateY(8px) scale(1);
}
